/* Copyright ABCya.com, LLC 
 Fri, 04 Mar 2022 16:45:54 GMT */
function getUrlParams(){var a={};return window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(b,c,d){a[c]=d}),a}function getRandom(a,b){return Math.floor(Math.random()*(1+b-a)+a)}function numberWithCommas(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function str_pad_left(a,b,c){return(new Array(c+1).join(b)+a).slice(-c)}function shuffleArray(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a}function pxValue(a){return a+"px"}function createCenteredText(a,b,c,d){for(var e=new createjs.Container,f=a.split("\n"),g=0;g<f.length;g++){var h=new createjs.Text(f[g],b+"pt "+c,d);h.textBaseline="hanging",h.x=h.getMeasuredWidth()/2*-1,g>0&&(h.y=f[g-1].y+f[g-1].getMeasuredHeight()+5),e.addChild(h),f[g]=h}return e}!function(a){function b(){this.commonAudioPath=abcya.GameConstants.COMMON_AUDIO_ASSETS_PATH,this.commonImagePath=abcya.GameConstants.COMMON_IMAGE_ASSETS_PATH,this.localAudioPath=abcya.GameConstants.AUDIO_ASSETS_PATH,this.localImagePath=abcya.GameConstants.IMAGE_ASSETS_PATH,this.localDataPath=abcya.GameConstants.DATA_ASSETS_PATH,this.preload=new createjs.LoadQueue,this.preload.setMaxConnections(4),this.preload.installPlugin(createjs.Sound),createjs.Sound.alternateExtensions=["mp3"]}a.abcya=a.abcya||{},b.prototype={},b.prototype.preload=null,b.prototype.ondownloadcompleted=null,b.prototype.preloadUpdater=null,b.prototype.spritesheet=null,b.prototype.dialogSheet=null,b.prototype.animationsheet=null,b.prototype.mathsheet=null,b.prototype.roundSelectPenguin=null,b.prototype.dropsheet=null,b.prototype.dropanimationsheet=null,b.prototype.startPreload=function(){this.preload.addEventListener("complete",this.handlePreloadComplete.bind(this)),this.preload.addEventListener("progress",this.handlePreloadProgress.bind(this));var a=abcya.GameConstants.COMMON_IMAGE_ASSETS_PATH,b=[{id:"preload-assets",src:"preload-assets.json"}];this.preload.loadManifest(b,!1,a),this.preload.load()},b.prototype.handlePreloadProgress=function(a){},b.prototype.handlePreloadComplete=function(a){this.preload.removeAllEventListeners(),this.ondownloadcompleted()},b.prototype.startDownload=function(){this.preload.addEventListener("complete",this.handleDownloadComplete.bind(this)),this.preload.addEventListener("progress",this.handleDownloadProgress.bind(this));var a=abcya.GameConstants.IMAGE_ASSETS_PATH,b=[{id:"dropHelpOverlay",src:"DropHelpOverlay.png"},{id:"animationData",src:"mmAnimations.json"},{id:"animationSheet1",src:"mmAnimations_0.png"},{id:"animationSheet2",src:"mmAnimations_1.png"},{id:"marbleMathCommonData",src:"mm_common_assets.json"},{id:"marbleMathCommonSheet",src:"mm_common_assets.png"},{id:"marbleDropData",src:"md_assets.json"},{id:"marbleDropSheet",src:"md_assets.png"},{id:"marbleDropAnimationData",src:"MarbleDropAnimationSmall.json"},{id:"marbleDropAnimationSheet",src:"MarbleDropAnimationSmall.png"}];if("MATH"===abcya.GameConfig.GAME_MODE?(b.push({id:"IntroBackground_n",src:"4x3/IntroBackground.png"}),b.push({id:"IntroBackground_w",src:"16x9/IntroBackground.png"}),b.push({id:"DropBackground_n",src:"4x3/DropBackground.png"}),b.push({id:"DropBackground_w",src:"16x9/DropBackground.png"}),b.push({id:"DropResultsBackground_w",src:"16x9/DropResultsBackground.png"}),b.push({id:"DropResultsBackground_n",src:"4x3/DropResultsBackground.png"})):(b.push({id:"IntroBackground_n",src:"4x3/DropIntroBackground.png"}),b.push({id:"IntroBackground_w",src:"16x9/DropIntroBackground.png"}),b.push({id:"DropBackground_n",src:"4x3/DropDropBackground.png"}),b.push({id:"DropBackground_w",src:"16x9/DropDropBackground.png"}),b.push({id:"DropResultsBackground_w",src:"16x9/DropDropResultsBackground.png"}),b.push({id:"DropResultsBackground_n",src:"4x3/DropDropResultsBackground.png"})),this.preload.loadManifest(b,!1,a),a=abcya.GameConstants.AUDIO_ASSETS_PATH,b=[{id:"MarbleSound",src:"MarbleSound.ogg",data:3},{id:"click",src:"click.ogg",data:1},{id:"MarbleMathSound",src:"marblemath.ogg",data:1},{id:"ThemeSound",src:"ThemeSound.ogg",data:1},{id:"SlideWhistleSound",src:"SlideWhistleSound.ogg",data:1},{id:"CorrectMarkSound",src:"CorrectMark.ogg",data:2},{id:"IncorrectMarkSound",src:"IncorrectMark.ogg",data:2},{id:"LevelUpSound",src:"LevelUp.ogg",data:1},{id:"PlacedSound",src:"PlacedSound.ogg",data:2},{id:"RemovedSound",src:"RemovedSound.ogg",data:2},{id:"saveStartOverSound",src:"save-print-startOver.ogg",data:1}],this.preload.loadManifest(b,!1,a),b=[{id:"marbleDropInstructionsSound",src:"MarbleDropInstructions.ogg",data:1},{id:"marbleDropTitleSound",src:"MarbleDropTitle.ogg",data:1},{id:"penguinRunSound",src:"PenguinRun.ogg",data:1}],this.preload.loadManifest(b,!1,a),"MATH"===abcya.GameConfig.GAME_MODE){a=abcya.GameConstants.IMAGE_ASSETS_PATH;var b=[{id:"marbleDropBox",src:"DropBox.png"},{id:"marbleMathData",src:"mm_assets.json"},{id:"marbleMathSheet",src:"mm_assets.png"},{id:"roundSelectPenguinData",src:"PenguinTalking2a.json"},{id:"roundSelectPenguinSheet",src:"PenguinTalking2a_0.png"},{id:"roundSelectPenguinSheet1",src:"PenguinTalking2a_1.png"},{id:"HelpDisplay_normal",src:"HelpDisplay_n.png"},{id:"HelpDisplay_wide",src:"HelpDisplay_w.png"},{id:"GameBackground_w",src:"16x9/GameBackground.png"},{id:"ResultsBackground_w",src:"16x9/ResultsBackground.png"},{id:"RoundSelectBackground_w",src:"16x9/RoundSelectBackground.png"},{id:"GameBackground_n",src:"4x3/GameBackground.png"},{id:"IntroBackground_n",src:"4x3/IntroBackground.png"},{id:"ResultsBackground_n",src:"4x3/ResultsBackground.png"},{id:"RoundSelectBackground_n",src:"4x3/RoundSelectBackground.png"}];this.preload.loadManifest(b,!1,a),a=abcya.GameConstants.AUDIO_ASSETS_PATH,b=[{id:"RoundSelectSound",src:"RoundSelectSound.ogg",data:1},{id:"CorrectSound",src:"CorrectSound.ogg",data:1},{id:"RadicalSound",src:"RadicalSound.ogg",data:1},{id:"SweetSound",src:"SweetSound.ogg",data:1},{id:"GotItSound",src:"GotItSound.ogg",data:1},{id:"GroovySound",src:"GroovySound.ogg",data:1},{id:"AwesomeSound",src:"AwesomeSound.ogg",data:1},{id:"MoreThanSound",src:"MoreThanSound.ogg",data:1},{id:"TooLittleSound",src:"TooLittleSound.ogg",data:1},{id:"LessThanSound",src:"LessThanSound.ogg",data:1},{id:"TooMuchSound",src:"TooMuchSound.ogg",data:1},{id:"HowManySound",src:"HowManySound.ogg",data:1},{id:"PlusSound",src:"PlusSound.ogg",data:1},{id:"HintSound",src:"hint-marble-math.ogg",data:1},{id:"InstSound",src:"InstSound.ogg",data:1},{id:"ResultsSound",src:"Results.ogg",data:1},{id:"TryAgainSound",src:"TryAgainSound.ogg",data:1},{id:"NextLevelSound",src:"NextLevelSound.ogg",data:1}],this.preload.loadManifest(b,!1,a),b=[],a=this.commonAudioPath+"numbers/";for(var c=0;c<=25;c++){var d="Sound"+c,e=d+".ogg";b.push({id:d,src:e,data:1})}this.preload.loadManifest(b,!1,a)}this.preload.load()},b.prototype.handleDownloadProgress=function(a){this.preloadUpdater&&this.preloadUpdater.setProgress(a.progress)},b.prototype.handleDownloadComplete=function(a){this.preload.removeAllEventListeners(),this.animationsheet=new createjs.SpriteSheet(this.getAsset("animationData")),this.commonsheet=new createjs.SpriteSheet(this.getAsset("marbleMathCommonData")),this.dropsheet=new createjs.SpriteSheet(this.getAsset("marbleDropData")),this.dropanimationsheet=new createjs.SpriteSheet(this.getAsset("marbleDropAnimationData")),"MATH"===abcya.GameConfig.GAME_MODE&&(this.mathsheet=new createjs.SpriteSheet(this.getAsset("marbleMathData")),this.roundSelectPenguin=new createjs.SpriteSheet(this.getAsset("roundSelectPenguinData"))),this.ondownloadcompleted(),this.ondownloadcompleted=null,this.preloadUpdater=null},b.prototype.setDownloadCompleted=function(a){this.ondownloadcompleted=a},b.prototype.setPreloadViewUpdate=function(a){this.preloadUpdater=a},b.prototype.getAsset=function(a){return this.preload.getResult(a)},a.abcya.AssetsManager=b}(window),function(){window.abcya=window.abcya||{};var a={GS_PRELOAD:0,GS_RUNSCENE:1,GS_ROUND_SELECTION:4,GS_INTRO:3,GS_GAME:10,GS_RESULTS_SCREEN:11,GS_MARBLE_DROP:20,GS_MARBLE_DROP_RESULTS:21},b={GE_INTRO:"main_menu_event",GE_GO_CLICK:"show_round_select",GE_ROUND_SELECT:"level_select_event",GE_ROUND_FINISHED:"round_finished",GE_SHOW_GAME:"show_game",GE_SHOW_RESULTS:"show_results",GE_SHOW_ROUND_SELECT:"show_round_select",GE_SHOW_MARBLE_DROP:"show_marble_drop",GE_SHOW_MARBLE_DROP_RESULTS:"show_marble_drop_results"};window.abcya.GameStates=a,window.abcya.GameStateEvents=b;var c={FPS:60,DO_ORIENTATION_BLOCK:!0,EXIT_URL:"../../../",FORCE_NORMAL_RATIO:!1,GAME_ORIENTATION:"Landscape",GAME_FONTS:["vagrounded_btregular"],USES_STORAGE:!1,STORAGE_PREFIX:"starter_game",STORAGE_TYPE:"local",GAME_MODE:"MATH",ROUND_QUESTION_COUNT:10,KEY_UP:"key_up",KEY_DOWN:"key_down",KEY_LEFT:"key_left",KEY_RIGHT:"key_right",SET_CATCHING:"set_catching",KEY_SUBMIT:"key_submit",CONTROL_TYPE:"keys",MARBLE_SPAWNTIME:2845,MARBLE_SPEED:40,MAX_MARBLE_VALUE:10,MAX_DROP_VALUE:5};window.abcya.GameConfig=c}(),function(a){function b(){this.platformData=null,this.canvas=null,this.gameWrapper=null,this.stage=null,this.screen_width=null,this.screen_height=null,this.isWidescreen=null,this.hasFocus=!0,this.isMobile=!1,this.deviceType=null,this.tranformTypePrefix="",this.preloader=null,this.sceneManager=null,this.assets=null,this.orientation=null,this.orientationDimensions=null,this.isMuted=!1,this.isPaused=!1,this.force43=!1,this.curCSSLeft=null,this.curCSSTop=null,this.curCSSScale=null,this.initialize()}a.abcya=a.abcya||{};var c=b.prototype={};c.initialize=function(){this.platformData=abcyaWindow.abcya.platformData,this.orientation=abcya.GameConfig.GAME_ORIENTATION,this.isMobile=this.platformData.isMobile,this.force43=this.platformData.force43,this.tranformTypePrefix=this.platformData.tranformTypePrefix,this.deviceType=this.platformData.deviceType,this.canvas=document.getElementById("gameCanvas"),this.gameWrapper=document.getElementById("gameWrapper"),this.stage=new createjs.Stage(this.canvas),this.orientation===abcya.GameConstants.PORTRAIT?this.orientationDimensions={normal:{width:abcya.GameConstants.ORIENTATION_DIMS[1],height:abcya.GameConstants.ORIENTATION_DIMS[0]},widescreen:{width:abcya.GameConstants.ORIENTATION_DIMS[2],height:abcya.GameConstants.ORIENTATION_DIMS[0]}}:this.orientationDimensions={normal:{width:abcya.GameConstants.ORIENTATION_DIMS[0],height:abcya.GameConstants.ORIENTATION_DIMS[1]},widescreen:{width:abcya.GameConstants.ORIENTATION_DIMS[0],height:abcya.GameConstants.ORIENTATION_DIMS[2]}},this.stage.width=this.orientationDimensions.normal.width,this.stage.height=this.orientationDimensions.normal.height,this.platformData.allowsTouch===!0&&createjs.Touch.isSupported()&&createjs.Touch.enable(this.stage),this.platformData.allowsMouseover===!0&&this.stage.enableMouseOver(),this.platformData.pauseEvent&&a.parent.addEventListener(this.platformData.pauseEvent,this.handleViewFocusEvent.bind(this),!1),createjs.Ticker.timingMode=createjs.Ticker.RAF,createjs.Ticker.maxDelta=50,createjs.Ticker.setFPS(abcya.GameConfig.FPS)},c.setGameRatio=function(){if(this.force43===!0)return void this.force4x3();var b=a.innerWidth,c=a.innerHeight,d=Math.max(b,c),e=Math.min(b,c),f=d/e,g=this.isWidescreen;f<1.4?(this.isWidescreen=!1,this.stage.canvas.width=this.orientationDimensions.normal.width,this.stage.canvas.height=this.orientationDimensions.normal.height):(this.isWidescreen=!0,this.stage.canvas.width=this.orientationDimensions.widescreen.width,this.stage.canvas.height=this.orientationDimensions.widescreen.height),this.screen_width=this.canvas.width,this.screen_height=this.canvas.height,this.updateBgImage(),game&&g!=this.isWidescreen&&this.layoutScreens()},c.force4x3=function(){var a=this.isWidescreen;this.isWidescreen=!1,this.stage.canvas.width=this.orientationDimensions.normal.width,this.stage.canvas.height=this.orientationDimensions.normal.height,this.screen_width=this.canvas.width,this.screen_height=this.canvas.height,this.updateBgImage(),game&&a!=this.isWidescreen&&this.layoutScreens()},c.updateBgImage=function(){if(!abcya.GameConfig.HAS_BG_IMG){var a=this.isWidescreen?"BlankBackground_16x9.png":"BlankBackground_4x3.png";document.getElementById("bg").src=abcya.GameConstants.COMMON_IMAGE_ASSETS_PATH+this.orientation+a}},c.resizeGame=function(){this.setGameRatio();var b,c=a.innerWidth,d=a.innerHeight,e=this.screen_width/this.screen_height,f=a.innerWidth,g=a.innerHeight,h=f/g,i=0,j=0;h>e?(f=g*e,b=f/this.screen_width):(g=f/e,b=g/this.screen_height),this.platformData.maxViewScale>0&&b>this.platformData.maxViewScale?(b=1,j=(d-game.screen_height)/2,i=(c-game.screen_width)/2):(j=(d-g)/2,i=(c-f)/2),this.curCSSLeft=i,this.curCSSTop=j,this.curCSSScale=b,this.gameWrapper.style.left=pxValue(i),this.gameWrapper.style.top=pxValue(j),this.canvas.style.left=pxValue(i),this.canvas.style.top=pxValue(j);var k=document.getElementById("bg");k.setAttribute("style",this.tranformTypePrefix+"transform:scale("+b+")"),this.canvas.setAttribute("style",this.tranformTypePrefix+"transform:scale("+b+")"),this.sceneManager&&this.sceneManager.gameResized&&this.sceneManager.gameResized()},c.focusCheck=function(a){"pagehide"==a.type||"blur"==a.type||1==document.hidden||1==document.webkitHidden?game.hasFocus=!1:game.hasFocus=!0,game.isPaused||game.sceneManager&&game.sceneManager.forcePauseState&&game.sceneManager.forcePauseState(!game.hasFocus)},c.handleViewFocusEvent=function(a){this.setPaused(a.detail.paused)},c.setPaused=function(a){this.isPaused=a,game.sceneManager&&game.sceneManager.forcePauseState&&game.sceneManager.forcePauseState(this.isPaused)},c.initGame=function(){a.onresize=this.resizeGame.bind(this),this.resizeGame(),document.addEventListener("visibilitychange",this.focusCheck,!1),document.addEventListener("webkitvisibilitychange",this.focusCheck,!1),document.addEventListener("pagehide",this.focusCheck,!1),document.addEventListener("pageshow",this.focusCheck,!1);var b=this.focusCheck.bind(this);a.onblur=b,a.onfocus=b,this.assets=new abcya.AssetsManager,game.assets=this.assets,this.assets.setDownloadCompleted(this.handlePreloadComplete.bind(this)),this.assets.startPreload()},c.handlePreloadComplete=function(){this.preloader=new abcya.PreloadScreen,this.preloader.on("PRELOAD_CLICK",this.startGame,this),this.stage.addChild(this.preloader),this.stage.update(),this.assets.setDownloadCompleted(this.gameAssetsReady.bind(this)),this.assets.setPreloadViewUpdate(this.preloader),this.assets.startDownload(),this.gameWrapper.style.visibility="visible"},c.gameAssetsReady=function(){this.preloader.addClick(),abcya.GameConfig.DELAYED_SOUND_QUEUE&&abcya.GameConfig.DELAYED_SOUND_QUEUE.length>0&&this.assets.startDelayedDownload()},c.startGame=function(a){this.stage.removeChild(this.preloader),this.preloader=null,this.sceneManager=new abcya.SceneManager},c.playSound=function(a,b,c){var d=null;if(b||(b=0),b===!0&&(b=-1),c||(c=0),!game.isMuted){var e=(new createjs.PlayPropsConfig).set({interrupt:createjs.Sound.INTERRUPT_ANY,loop:b,delay:c});d=createjs.Sound.play(a,e)}return d},c.layoutScreens=function(){this.preloader?this.preloader.layoutRatio():this.sceneManager&&this.sceneManager.layoutScreens()},a.abcya.GameMain=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype={},b.prototype.currentScene=null,b.prototype.currentStateFunction=null,b.prototype.gameBg=null,b.prototype.currentBg=null,b.prototype.mainUIDisplay=null,b.prototype.showfps=!1,b.prototype.fpsLabel=null,b.prototype.initialize=function(){game.gameData=new abcya.GameData;var a=game.isWidescreen?"mainBgWide":"mainBg";this.gameBg=new createjs.Bitmap(game.assets.getAsset(a)),this.currentBg="IntroBackground",this.setBg(),game.stage.addChild(this.gameBg),createjs.Ticker.on("tick",this.gameLoop,this),this.changeState(abcya.GameStates.GS_INTRO),"MATH"===abcya.GameConfig.GAME_MODE&&box2d.setup(),this.showfps&&(this.fpsLabel=new createjs.Text("--fps","12pt Arial","#000"),this.fpsLabel.x=5,this.fpsLabel.y=40,game.stage.addChild(this.fpsLabel))},b.prototype.changeState=function(a){switch(a){case abcya.GameStates.GS_INTRO:this.currentStateFunction=this.gameStateShowIntro;break;case abcya.GameStates.GS_MARBLE_DROP:this.currentStateFunction=this.gameStateShowMarbleDrop;break;case abcya.GameStates.GS_MARBLE_DROP_RESULTS:this.currentStateFunction=this.gameStateShowMarbleDropResults;break;case abcya.GameStates.GS_ROUND_SELECTION:this.currentStateFunction=this.gameStateRoundSelect;break;case abcya.GameStates.GS_GAME:this.currentStateFunction=this.gameStateShowGame;break;case abcya.GameStates.GS_RESULTS_SCREEN:this.currentStateFunction=this.gameStateShowResults;break;case abcya.GameStates.GS_RUNSCENE:this.currentStateFunction=this.gameStateRunScene}},b.prototype.gameStateRunScene=function(a){this.currentScene.tick&&game.hasFocus&&this.currentScene.tick(a)},b.prototype.gameStateShowIntro=function(a){if("MATH"===abcya.GameConfig.GAME_MODE){var b=new abcya.IntroScreen;b.on(abcya.GameStateEvents.GE_GO_CLICK,this.onStateEvent,this,!1,{state:abcya.GameStates.GS_ROUND_SELECTION})}else{var b=new abcya.DropIntroScreen;b.on(abcya.GameStateEvents.GE_GO_CLICK,this.onStateEvent,this,!1,{state:abcya.GameStates.GS_MARBLE_DROP})}game.stage.addChild(b),this.mainUIDisplay&&game.stage.addChild(this.mainUIDisplay),this.currentScene&&game.stage.removeChild(this.currentScene),this.currentScene=b,this.changeState(abcya.GameStates.GS_RUNSCENE)},b.prototype.gameStateShowMarbleDrop=function(a){createjs.Sound.stop(),game.bgMusic=null;var b=new abcya.MarbleDrop;b.on(abcya.GameStateEvents.GE_SHOW_MARBLE_DROP_RESULTS,this.onStateEvent,this,!1,{state:abcya.GameStates.GS_MARBLE_DROP_RESULTS}),game.stage.addChild(b),this.mainUIDisplay&&game.stage.addChild(this.mainUIDisplay),game.stage.removeChild(this.currentScene),this.currentScene=b,this.changeState(abcya.GameStates.GS_RUNSCENE)},b.prototype.gameStateShowMarbleDropResults=function(a){createjs.Sound.stop(),game.bgMusic=null;var b=new abcya.MarbleDropResults;"MATH"===abcya.GameConfig.GAME_MODE?b.on(abcya.GameStateEvents.GE_SHOW_MARBLE_DROP,this.onStateEvent,this,!1,{state:abcya.GameStates.GS_ROUND_SELECTION}):b.on(abcya.GameStateEvents.GE_SHOW_MARBLE_DROP,this.onStateEvent,this,!1,{state:abcya.GameStates.GS_MARBLE_DROP}),game.stage.addChild(b),this.mainUIDisplay&&game.stage.removeChild(this.mainUIDisplay),game.stage.removeChild(this.currentScene),this.currentScene=b,this.changeState(abcya.GameStates.GS_RUNSCENE)},b.prototype.gameStateRoundSelect=function(a){var b=new abcya.RoundSelectScreen;b.on(abcya.GameStateEvents.GE_ROUND_SELECT,this.onStateEvent,this,!1,{state:abcya.GameStates.GS_GAME}),b.on(abcya.GameStateEvents.GE_SHOW_MARBLE_DROP,this.onStateEvent,this,!1,{state:abcya.GameStates.GS_MARBLE_DROP}),game.stage.addChild(b),this.mainUIDisplay&&game.stage.removeChild(this.mainUIDisplay),game.stage.removeChild(this.currentScene),this.currentScene=b,this.changeState(abcya.GameStates.GS_RUNSCENE)},b.prototype.gameStateShowGame=function(a){var b=new abcya.GameScreen;b.on(abcya.GameStateEvents.GE_SHOW_RESULTS,this.onStateEvent,this,!1,{state:abcya.GameStates.GS_RESULTS_SCREEN}),game.stage.addChild(b),this.mainUIDisplay&&game.stage.addChild(this.mainUIDisplay),game.stage.removeChild(this.currentScene),this.currentScene=b,this.changeState(abcya.GameStates.GS_RUNSCENE)},b.prototype.gameStateShowResults=function(a){var b=new abcya.ResultsScreen;b.on(abcya.GameStateEvents.GE_SHOW_ROUND_SELECT,this.onStateEvent,this,!1,{state:abcya.GameStates.GS_ROUND_SELECTION}),game.stage.addChild(b),this.mainUIDisplay&&game.stage.removeChild(this.mainUIDisplay),game.stage.removeChild(this.currentScene),this.currentScene=b,this.changeState(abcya.GameStates.GS_RUNSCENE)},b.prototype.setBg=function(){var a=game.isWidescreen?"w":"n";this.gameBg.image=game.assets.getAsset(this.currentBg+"_"+a)},b.prototype.onStateEvent=function(a,b){this.changeState(b.state)},b.prototype.gameLoop=function(a){null!=this.currentStateFunction&&this.currentStateFunction(a),this.showfps&&(this.fpsLabel.text=Math.floor(createjs.Ticker.getMeasuredFPS())+" FPS"),game.stage.update()},b.prototype.forcePauseState=function(a){createjs.Ticker.paused=a,this.currentScene&&this.currentScene.pauseGame&&this.currentScene.pauseGame(a)},b.prototype.gameFocusChange=function(){box2d&&box2d.pauseResume(!game.hasFocus)},b.prototype.layoutScreens=function(){if(this.currentScene){var a=game.isWidescreen?"w":"n";this.gameBg.image=game.assets.getAsset(this.currentBg+"_"+a),this.currentScene.layoutRatio&&this.currentScene.layoutRatio()}},a.abcya.SceneManager=b}(window);var resizeDimensions=function(a,b,c,d){var e=a,f=b,g=1;return e>f&&e>c?(g=c/e,f*=g,e=c):f>d&&(g=d/f,e*=g,f=d),{width:e,height:f,scale:g}};!function(a){function b(a,b,c){this.initialize(a,b,c)}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.cover=null,b.prototype.boxContainer=null,b.prototype.bg=null,b.prototype.lblMsg=null,b.prototype.btnYes=null,b.prototype.btnNo=null,b.prototype.initialize=function(a,b,c){this.Container_initialize(),c||(c=48),this.cover=new createjs.Shape;var d=this.cover.graphics;d.beginFill("#000"),d.drawRect(0,0,game.screen_width,game.screen_height),this.cover.alpha=.9,this.addChild(this.cover),this.boxContainer=new createjs.Container,this.bg=new createjs.Sprite(game.assets.commonsheet,a),this.bg.x=game.screen_width/2-this.bg.getBounds().width/2,this.bg.y=game.screen_height/2-this.bg.getBounds().height/2,this.boxContainer.addChild(this.bg),this.lblMsg=new createjs.Text(b,c+"pt vagrounded_btregular","#000"),this.lblMsg.textAlign="center",this.lblMsg.x=this.bg.x+this.bg.getBounds().width/2,this.lblMsg.y=this.bg.y+35,this.boxContainer.addChild(this.lblMsg),this.btnYes=new createjs.Sprite(game.assets.commonsheet,"BtnYes"),this.btnYes.x=this.bg.getBounds().width/2-this.btnYes.getBounds().width+this.bg.x,this.btnYes.y=this.bg.getBounds().height-this.btnYes.getBounds().height-40+this.bg.y,this.btnYes.on("click",this.onClickYes,this),this.boxContainer.addChild(this.btnYes),this.btnNo=new createjs.Sprite(game.assets.commonsheet,"BtnNo"),this.btnNo.x=this.bg.getBounds().width/2+20+this.bg.x,this.btnNo.y=this.bg.getBounds().height-this.btnYes.getBounds().height-40+this.bg.y,this.btnNo.on("mousedown",this.onClickNo,this),this.boxContainer.addChild(this.btnNo),this.boxContainer.regX=this.bg.getBounds().width,this.boxContainer.regY=this.bg.getBounds().height,this.boxContainer.x=this.bg.getBounds().width,this.boxContainer.y=this.bg.getBounds().height,this.boxContainer.scaleX=0,this.boxContainer.scaleY=0,createjs.Tween.get(this.boxContainer).to({scaleX:1,scaleY:1},1200,createjs.Ease.elasticOut),this.addChild(this.boxContainer),this.cover.on("mousedown",this.noClickThrough,this)},b.prototype.onClickYes=function(a){this.dispatchEvent(new createjs.Event("YES"))},b.prototype.onClickNo=function(a){this.dispatchEvent(new createjs.Event("NO"))},b.prototype.noClickThrough=function(a){},a.abcya.ConfirmDialog=b}(window),function(a){function b(){this.currentRound=1,this.roundReached=1,this.lastRoundUnlocked=1,this.roundResults=[0,0,0,0,0],this.showedHelped=!0,this.playedRoundInstructions=!1}a.abcya=a.abcya||{},b.prototype={},b.prototype.currentRound=null,b.prototype.roundReached=null,b.prototype.roundResults=null,b.prototype.getCurrentResults=function(){return this.roundResults[this.currentRound-1]},b.prototype.levelUp=function(){this.currentRound++,this.roundReached=this.currentRound},a.abcya.GameData=b}(window);var b2Vec2=Box2D.Common.Math.b2Vec2,b2BodyDef=Box2D.Dynamics.b2BodyDef,b2Body=Box2D.Dynamics.b2Body,b2FixtureDef=Box2D.Dynamics.b2FixtureDef,b2Fixture=Box2D.Dynamics.b2Fixture,b2World=Box2D.Dynamics.b2World,b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape,b2CircleShape=Box2D.Collision.Shapes.b2CircleShape,b2DebugDraw=Box2D.Dynamics.b2DebugDraw,b2ContactListener=Box2D.Dynamics.b2ContactListener,lastCollisionTime,box2d=function(){var a,b=30,c=20,d=1/c,e=Date.now(),f=0,g=[],h=[],i=[],j=function(){a=new b2World(new b2Vec2(0,10),(!0)),a.SetContactListener(q);var c=new b2FixtureDef;c.density=1,c.restitution=.2,c.shape=new b2PolygonShape,c.shape.SetAsBox(300/b/2,5/b/2);var d=new b2BodyDef;d.type=b2Body.b2_staticBody,d.position.x=150/b,d.position.y=260/b;var e=a.CreateBody(d);e.CreateFixture(c);var f=new b2FixtureDef;f.shape=new b2PolygonShape,f.shape.SetAsBox(1/b/2,260/b/2);var g=new b2BodyDef;g.type=b2Body.b2_staticBody,g.position.x=2/b,g.position.y=110/b;var h=a.CreateBody(g);h.CreateFixture(f);var i=new b2FixtureDef;i.shape=new b2PolygonShape,i.shape.SetAsBox(1/b,260/b);var j=new b2BodyDef;j.type=b2Body.b2_staticBody,j.position.x=310/b,j.position.y=2/b;var k=a.CreateBody(j);k.CreateFixture(i);var c=new b2FixtureDef;c.density=1,c.restitution=.2,c.shape=new b2PolygonShape,c.shape.SetAsBox(300/b/2,5/b/2);var d=new b2BodyDef;d.type=b2Body.b2_staticBody,d.position.x=470/b,d.position.y=260/b;var e=a.CreateBody(d);e.CreateFixture(c);var f=new b2FixtureDef;f.shape=new b2PolygonShape,f.shape.SetAsBox(1/b,260/b);var g=new b2BodyDef;g.type=b2Body.b2_staticBody,g.position.x=326/b,g.position.y=100/b;var h=a.CreateBody(g);h.CreateFixture(f);var i=new b2FixtureDef;i.shape=new b2PolygonShape,i.shape.SetAsBox(1/b,260/b);var j=new b2BodyDef;j.type=b2Body.b2_staticBody,j.position.x=630/b,j.position.y=100/b;var k=a.CreateBody(j);k.CreateFixture(i)},k=function(a,c){this.body=a,this.skin=c,this.update=function(){this.skin.rotation=this.body.GetAngle()*(180/Math.PI),this.skin.x=this.body.GetWorldCenter().x*b,this.skin.y=this.body.GetWorldCenter().y*b},h.push(this)},l=function(a){game.stage.removeChild(a.skin),h.splice(h.indexOf(a),1)},m=function(){var b=Date.now(),i=b-e;for(f+=i,e=b;f>=c;){for(var j=0,k=g.length;j<k;j++)l(g[j].GetUserData()),g[j].SetUserData(null),a.DestroyBody(g[j]);g=[];for(var j=0,k=h.length;j<k;j++)h[j].update();a.Step(d,10,10),f-=c,a.ClearForces(),a.m_debugDraw&&a.m_debugDraw.m_sprite.graphics.clear(),a.DrawDebugData()}},n=function(a){d=a?0:1/c,e=Date.now()},o=function(c){var d=new b2FixtureDef;d.density=1,d.restitution=.2,d.shape=new b2CircleShape(25/b);var e=new b2BodyDef;e.type=b2Body.b2_dynamicBody,e.position.x=c.x/b,e.position.y=c.y/b;var f=a.CreateBody(e);f.CreateFixture(d);var g=new k(f,c);return f.SetUserData(g),i.push(f),f},p=function(b){var c=i.indexOf(b);l(b.GetUserData()),b.SetUserData(null),a.DestroyBody(b),i.splice(c,1)},q=new b2ContactListener;return q.BeginContact=function(a){var b=a.GetFixtureA().GetBody(),c=a.GetFixtureB().GetBody();b.m_userData&&c.m_userData&&createjs.Sound.play("MarbleSound")},{setup:j,update:m,createMarble:o,removeMarble:p,pauseResume:n}}();!function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.bg=null,b.prototype.helpOverlay=null,b.prototype.initialize=function(){this.Container_initialize(),this.bg=new createjs.Shape;var a=this.bg.graphics;a.beginFill(createjs.Graphics.getRGB(255,255,255,1)),a.drawRect(0,0,game.screen_width,game.screen_height),this.bg.alpha=.4,this.addChild(this.bg),this.helpOverlay=new createjs.Bitmap(game.assets.getAsset("dropHelpOverlay")),this.helpOverlay.x=game.screen_width/2-this.helpOverlay.getBounds().width/2,this.helpOverlay.y=40,this.addChild(this.helpOverlay)},a.abcya.DropHelpOverlay=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.scoreLabel=null,b.prototype.scoreText=null,b.prototype.goalLabel=null,b.prototype.goalText=null,b.prototype.btnSubmit=null,b.prototype.missContainer=null,b.prototype.misses=null,b.prototype.initialize=function(){this.Container_initialize(),this.scoreLabel=new createjs.Text("SCORE:","24pt vagrounded_btregular","#FFF"),this.scoreLabel.x=10,this.scoreText=new createjs.Text("0","24pt vagrounded_btregular","#FFF"),this.addChild(this.scoreLabel),this.scoreText.x=this.scoreLabel.getBounds().width+15,this.addChild(this.scoreText),this.goalLabel=new createjs.Text("MAKE","bold 18pt vagrounded_btregular","#FFF"),this.goalLabel.x=game.screen_width/2-this.goalLabel.getBounds().width/2,this.goalText=new createjs.Text("X","bold 36pt vagrounded_btregular","#FFF"),this.goalText.textAlign="center",this.goalText.x=game.screen_width/2,this.goalText.y=20,this.addChild(this.goalLabel),this.addChild(this.goalText);var a=new createjs.Shape,b=a.graphics;b.beginFill(createjs.Graphics.getRGB(24,155,155,1)),b.drawRect(game.screen_width/2-50,45,100,50,20),this.hitArea=a,this.addChild(this.btnSubmit),this.misses=[],this.missContainer=new createjs.Container;for(var c,d=0;d<3;d++)c=new createjs.Sprite(game.assets.dropsheet,"IncorrectaMark"),c.x=35*d+10,c.y=60,this.misses.push(c);this.addChild(this.missContainer)},b.prototype.showMiss=function(a){this.missContainer.addChild(this.misses[a-1])},b.prototype.onClick=function(){var a=new createjs.Event("SUBMIT_MARBLES");this.dispatchEvent(a)},a.abcya.DropHUD=b}(window),function(a){function b(a){this.initialize(a)}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.marble=null,b.prototype.numValue=null,b.prototype.label=null,b.prototype.speed=40,b.prototype.initialize=function(a){this.Container_initialize(),this.speed=abcya.GameConfig.MARBLE_SPEED,this.numValue=getRandom(1,a),this.marble=new createjs.Sprite(game.assets.dropsheet,"SmallMarble"+getRandom(1,9)),this.addChild(this.marble),this.label=new createjs.Text(this.numValue.toString(),"bold 13pt vagrounded_btregular","#FFF"),this.label.textAlign="center",this.label.x=this.marble.getBounds().width/2,this.label.y=this.marble.getBounds().height/2-this.label.getBounds().height/2,this.addChild(this.label)},b.prototype.setupForEquation=function(){this.regX=this.getBounds().width/2,this.regY=this.getBounds().height/2},b.prototype.pulse=function(){createjs.Tween.get(this).to({scaleX:1.3,scaleY:1.3},400).call(this.pulseBack,!1,this),createjs.Sound.play("CorrectMarkSound")},b.prototype.pulseBack=function(){createjs.Tween.get(this).to({scaleX:1,scaleY:1},350).call(this.donePulsing,!1,this)},b.prototype.donePulsing=function(){var a=new createjs.Event("MARBLE_ADDED_ANIMATION_OVER");this.dispatchEvent(a)},b.prototype.tick=function(a){this.y+=this.speed*(a.delta/1e3)},a.abcya.DroppingMarble=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.btnLeft=null,b.prototype.btnRight=null,b.prototype.initialize=function(){this.Container_initialize();var a=game.assets.dropsheet;this.btnLeft=new createjs.Sprite(a,"ArrowRight"),this.btnLeft.scaleX=-1,this.btnLeft.x=this.btnLeft.getBounds().width+20,this.btnLeft.y=game.screen_height/2-this.btnLeft.getBounds().height/2,this.btnLeft.on("mousedown",this.buttonPressed,this,!1,{type:abcya.GameConfig.KEY_LEFT}),this.btnLeft.on("pressup",this.buttonRelease,this,!1,{name:"ArrowRight",type:"STOP_PENGUIN"}),this.addChild(this.btnLeft),this.btnRight=new createjs.Sprite(a,"ArrowRight"),this.btnRight.x=game.screen_width-this.btnRight.getBounds().width-20,this.btnRight.y=game.screen_height/2-this.btnRight.getBounds().height/2,this.btnRight.on("mousedown",this.buttonPressed,this,!1,{type:abcya.GameConfig.KEY_RIGHT}),this.btnRight.on("pressup",this.buttonRelease,this,!1,{name:"ArrowRight",type:"STOP_PENGUIN"}),this.addChild(this.btnRight)},b.prototype.buttonPressed=function(a,b){a.currentTarget.gotoAndPlay("ArrowOn");var c=new createjs.Event("CONTROL_INPUT");c.objData=b.type,this.dispatchEvent(c)},b.prototype.buttonRelease=function(a,b){if(a.currentTarget.gotoAndPlay(b.name),b.type){var c=new createjs.Event("CONTROL_INPUT",(!1),(!1));c.objData=b.type,this.dispatchEvent(c)}},b.prototype.layoutRatio=function(){var a;a=game.isWidescreen?60:0,this.btnLeft.y=game.screen_height/2-this.btnLeft.getBounds().height/2+a,this.btnRight.y=game.screen_height/2-this.btnRight.getBounds().height/2+a},a.abcya.GameScreenKeyControls=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},
b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.penguin=null,b.prototype.basketHit=null,b.prototype.basketContainer=null,b.prototype.xOffset=-45,b.prototype.vx=0,b.prototype.vy=0,b.prototype.destPoint=60,b.prototype.speed=200,b.prototype.initialize=function(){this.Container_initialize(),this.penguin=new createjs.Sprite(game.assets.dropanimationsheet,"idle");var a=new createjs.Shape,b=a.graphics;b.beginFill(createjs.Graphics.getRGB(24,155,155,1)),b.drawRect(0,0,80,25,20),this.basketHit=new createjs.Container,this.basketHit.addChild(a),this.basketHit.setBounds(0,0,80,25),this.basketHit.x=this.xOffset*-1,this.basketHit.y=15,this.basketHit.alpha=0,this.addChild(this.basketHit),this.addChild(this.penguin),this.basketContainer=new createjs.Container,this.basketContainer.x=this.xOffset*-1,this.addChild(this.basketContainer),this.minX=-50,this.maxX=890},b.prototype.setCatching=function(a){a?(this.penguin.scaleX=1.1,this.penguin.scaleY=1.1,this.penguin.x=-15,this.penguin.y=5,this.basketContainer.y=13):(this.penguin.scaleX=1,this.penguin.scaleY=1,this.penguin.x=0,this.penguin.y=0,this.basketContainer.y=0)},b.prototype.dropMarbles=function(){this.penguin.gotoAndPlay("dump")},b.prototype.setVelocity=function(a){0!=a?"run"!=this.penguin.currentAnimation&&this.penguin.gotoAndPlay("run"):this.penguin.gotoAndPlay("idle"),this.vx=this.speed*a},b.prototype.doRun=function(){"run"!=this.penguin.currentAnimation&&this.penguin.gotoAndPlay("run")},b.prototype.stopRun=function(){"idle"!=this.penguin.currentAnimation&&this.penguin.gotoAndPlay("idle")},b.prototype.setDestination=function(a){this.destPoint=a,this.doRun()},b.prototype.tick=function(a){if("keys"==abcya.GameConfig.CONTROL_TYPE){if(this.x>this.maxX&&this.vx>0||this.x<this.minX&&this.vx<0)return;this.x+=this.vx*(a.delta/1e3)}else{var b=this.destPoint-this.x,c=b>0?1:-1,d=this.speed*c*(a.delta/1e3);Math.abs(b)>Math.abs(d)?(this.x+=d,this.doRun()):(this.x=this.destPoint,this.stopRun())}},a.abcya.PenguinDropChar=b}(window),function(a){function b(a){this.initialize(a)}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.initialize=function(a){this.Container_initialize(),this.bg=new createjs.Shape;var b=this.bg.graphics;b.beginFill(createjs.Graphics.getRGB(255,255,255,1)),b.drawRect(0,0,game.screen_width,game.screen_height),this.bg.alpha=.4,this.addChild(this.bg),this.helpOverlay=new createjs.Bitmap(game.assets.getAsset(a)),this.helpOverlay.x=game.screen_width/2-this.helpOverlay.getBounds().width/2,this.helpOverlay.y=40,this.addChild(this.helpOverlay)},b.prototype.layoutRatio=function(a){a=game.isWidescreen;var b=a?"HelpDisplay_wide":"HelpDisplay_normal";this.helpOverlay.image=game.assets.getAsset(b);var c=this.bg.graphics;c.clear(),c.beginFill(createjs.Graphics.getRGB(255,255,255,1)),c.drawRect(0,0,game.screen_width,game.screen_height)},a.abcya.HelpOverlay=b}(window),function(a){function b(){this.initialize()}a.game=a.game||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.box1=null,b.prototype.box2=null,b.prototype.hintContainer=null,b.prototype.box1Hint=null,b.prototype.box2Hint=null,b.prototype.hintDisplay=null,b.prototype.boxShadow=null,b.prototype.marbleMenu=[],b.prototype.marbleShadows=null,b.prototype.draggingMarble=null,b.prototype.isDragging=!1,b.prototype.dragOffset={x:0,y:0},b.prototype.box1Marbles=[],b.prototype.box2Marbles=[],b.prototype.marbleTrash=[],b.prototype.lastCollisionTime=null,b.prototype.initialize=function(){this.Container_initialize(),this.marbleMenu=[],this.marbleShadows=[],this.box1Marbles=[],this.box2Marbles=[],this.marbleTrash=[],this.hintContainer=new createjs.Container,this.box1Hint=new createjs.Shape;var a=this.box1Hint.graphics;a.beginFill(createjs.Graphics.getRGB(255,255,0,1)),a.drawRoundRect(0,0,320,200,25),this.box1Hint.x=-5,this.box1Hint.y=63,this.hintContainer.addChild(this.box1Hint),this.box2Hint=new createjs.Shape;var a=this.box2Hint.graphics;a.beginFill(createjs.Graphics.getRGB(255,255,0,1)),a.drawRoundRect(0,0,320,200,25),this.box2Hint.x=320,this.box2Hint.y=63,this.hintContainer.alpha=0,this.hintContainer.addChild(this.box2Hint),this.lblMarbleCount=new createjs.Text("0","bold 32pt vagrounded_btregular","#000"),this.lblMarbleCount.textAlign="center",this.lblMarbleCount.textBaseline="center",this.lblMarbleCount.x=718,this.lblMarbleCount.y=170,this.hintContainer.addChild(this.lblMarbleCount),this.hintDisplay=new createjs.Sprite(game.assets.mathsheet,"HintDisplay"),this.hintDisplay.x=650,this.hintDisplay.y=83,this.addChild(this.hintDisplay),this.addChild(this.hintContainer),this.btnHint=new createjs.Sprite(game.assets.mathsheet,"BtnHint"),this.btnHint.x=290,this.btnHint.y=135,this.btnHint.on("mousedown",this.showHint,this),this.btnHint.on("pressup",this.hideHint,this),this.boxShadow=new createjs.Sprite(game.assets.mathsheet,"CounterBoxShadows"),this.boxShadow.x=-65,this.boxShadow.y=210,this.addChild(this.boxShadow),this.box1=new createjs.Bitmap(game.assets.getAsset("marbleDropBox")),this.box1.regX=this.box1.image.width/2,this.box1.regY=this.box1.image.height/2,this.box1.x=this.box1.image.width/2,this.box1.y=this.boxShadow.y-this.box1.image.height/2+this.boxShadow.getBounds().height/2-6,this.addChild(this.box1),this.box2=new createjs.Bitmap(game.assets.getAsset("marbleDropBox")),this.box2.regX=this.box2.image.width/2,this.box2.regY=this.box2.image.height/2,this.box2.x=325+this.box2.image.width/2,this.box2.y=this.boxShadow.y-this.box2.image.height/2+this.boxShadow.getBounds().height/2-6,this.addChild(this.box2),this.addChild(this.hintContainer),this.addChild(this.box1),this.addChild(this.box2),this.addChild(this.btnHint);for(var b=[{x:-200,y:30,type:9},{x:-270,y:30,type:10},{x:-200,y:100,type:1},{x:-270,y:100,type:2},{x:-200,y:170,type:4},{x:-270,y:170,type:5},{x:-1270,y:170,type:6},{x:-1270,y:170,type:7},{x:-1270,y:170,type:getRandom(1,10)},{x:-1270,y:170,type:3}],c=b.length,d=0;d<c;d++){var e=b[d],f=new abcya.MarbleDisplay(e.type),g=new createjs.Sprite(game.assets.mathsheet,"MarbleShadow");g.x=e.x+95,g.y=e.y+65,this.addChild(g),f.shadowGraphic=g,this.marbleShadows.push(g),f.x=e.x+120,f.y=e.y+40,f.on("mousedown",this.menuMarbleSelect,this),f.on("pressmove",this.menuMarbleDrag,this),f.on("pressup",this.menuMarbleRelease,this),this.marbleMenu.push(f),this.addChild(f)}},b.prototype.menuMarbleSelect=function(a){var b=a.currentTarget;if(!b.isGrabbed){b.shadowGraphic.alpha=b.alpha=0,b.isGrabbed=!0;var c=b.grabbedMarbleRef=new abcya.MarbleDisplay(a.target.marbleType);c.regX=25,c.regY=25,c.origX=c.x=b.x+25,c.origY=c.y=b.y+25,this.addChild(c);this.localToGlobal(a.stageX,a.stageY);c.offsetX=-this.x,c.offsetY=-this.y,game.isMobile&&(c.offsetY+=-42)}},b.prototype.menuMarbleDrag=function(a){var b=a.currentTarget,c=b.grabbedMarbleRef;c.x=a.stageX+c.offsetX,c.y=a.stageY+c.offsetY},b.prototype.menuMarbleRelease=function(a){var b=a.currentTarget,c=b.grabbedMarbleRef,d=!1;this.checkCollisionBox(c,this.box1)?this.box1Marbles.length<25&&(d=!0,this.box1Marbles.push(c)):this.checkCollisionBox(c,this.box2)&&this.box2Marbles.length<25&&(d=!0,this.box2Marbles.push(c)),c.removeAllEventListeners(),d?(c.x<5?c.x=5:c.x>295&&c.x<314?c.x=295:c.x>314&&c.x<326?c.x=326:c.x>613&&(c.x=613),c.body=box2d.createMarble(c),c.on("mousedown",this.pickupMarble,this),c.on("pressmove",this.moveMarble,this),c.on("pressup",this.moveMarbleDone,this),c=null,this.lblMarbleCount.text=""+(this.box1Marbles.length+this.box2Marbles.length),createjs.Sound.play("PlacedSound")):(createjs.Sound.play("RemovedSound"),createjs.Tween.get(c).to({y:game.screen_height+50,scaleX:1,scaleY:1},660,createjs.Ease.quadIn).call(this.removeDraggedMarble.bind(this)),this.marbleTrash.push(c),c=null),b.shadowGraphic.alpha=b.alpha=1,b.isGrabbed=!1,b.grabbedMarbleRef=null},b.prototype.pickupMarble=function(a){var b=a.target;box2d.removeMarble(b.body),b.body=null;var c=this.box1Marbles.indexOf(b);c>=0?this.box1Marbles.splice(c,1):(c=this.box2Marbles.indexOf(b),this.box2Marbles.splice(c,1)),this.lblMarbleCount.text=""+(this.box1Marbles.length+this.box2Marbles.length)},b.prototype.moveMarble=function(a){var b=a.currentTarget;b.x=a.stageX+b.offsetX,b.y=a.stageY+b.offsetY},b.prototype.moveMarbleDone=function(a){var b=a.currentTarget,c=!1;this.checkCollisionBox(b,this.box1)?this.box1Marbles.length<25&&(c=!0,this.box1Marbles.push(b)):this.checkCollisionBox(b,this.box2)&&this.box2Marbles.length<25&&(c=!0,this.box2Marbles.push(b)),b.removeAllEventListeners(),c?(b.x<5?b.x=5:b.x>295&&b.x<314?b.x=295:b.x>314&&b.x<326?b.x=326:b.x>613&&(b.x=613),b.body=box2d.createMarble(b),b.on("mousedown",this.pickupMarble,this),b.on("pressmove",this.moveMarble,this),b.on("pressup",this.moveMarbleDone,this),b=null,this.lblMarbleCount.text=""+(this.box1Marbles.length+this.box2Marbles.length),createjs.Sound.play("PlacedSound")):(createjs.Sound.play("RemovedSound"),createjs.Tween.get(b).to({y:game.screen_height+50,scaleX:1,scaleY:1},660,createjs.Ease.quadIn).call(this.removeDraggedMarble.bind(this)),this.marbleTrash.push(b),b=null)},b.prototype.tick=function(a){game.hasFocus&&(box2d.update(),this.addChild(this.btnHint))},b.prototype.showHint=function(){createjs.Sound.play("HintSound"),createjs.Tween.get(this.hintContainer,{override:!0}).to({alpha:1},400,createjs.Ease.quadOut)},b.prototype.hideHint=function(){createjs.Tween.get(this.hintContainer,{override:!0}).to({alpha:0},400,createjs.Ease.quadOut)},b.prototype.removeDraggedMarble=function(a){var b=this.marbleTrash.indexOf(a.target);this.removeChild(a.target),this.marbleTrash.splice(b,1)},b.prototype.checkCollisionBox=function(a,b){var c=!1,d=a.getBounds(),e=b.getBounds(),f=a.x-b.x,g=d.width/2+e.width/2;if(g=g,f>-g&&f<g){var h=a.y-b.y,i=d.height/2+e.height/2;i-=25,h>-i&&h<i&&(c=!0)}return c},b.prototype.reset=function(){var a,b;for(b=this.box1Marbles.length,a=0;a<b;a++)box2d.removeMarble(this.box1Marbles[a].body),this.marbleTrash.push(this.box1Marbles[a]),createjs.Tween.get(this.box1Marbles[a]).to({alpha:0},800,createjs.Ease.quadOut).call(this.removeDraggedMarble.bind(this));for(b=this.box2Marbles.length,a=0;a<b;a++)box2d.removeMarble(this.box2Marbles[a].body),this.marbleTrash.push(this.box2Marbles[a]),createjs.Tween.get(this.box2Marbles[a]).to({alpha:0},800,createjs.Ease.quadOut).call(this.removeDraggedMarble.bind(this));this.box1Marbles=[],this.box2Marbles=[],this.lblMarbleCount.text=""+(this.box1Marbles.length+this.box2Marbles.length)},b.prototype.layoutRatio=function(){var a,b,c;game.isWidescreen?(a=[{x:-80,y:70,type:9},{x:-150,y:70,type:10},{x:-80,y:140,type:1},{x:-150,y:140,type:2},{x:-80,y:210,type:4},{x:-150,y:210,type:5},{x:-1270,y:210,type:6},{x:-1270,y:210,type:7},{x:-1270,y:210,type:8},{x:-1270,y:210,type:3}],b=0,c=0):(a=[{x:0,y:0,type:1},{x:70,y:0,type:2},{x:140,y:0,type:3},{x:210,y:0,type:4},{x:280,y:0,type:5},{x:0,y:-70,type:6},{x:70,y:-70,type:7},{x:140,y:-70,type:getRandom(1,10)},{x:210,y:-70,type:9},{x:280,y:-70,type:10}],b=150,c=-10);for(var d=this.marbleMenu.length,e=0;e<d;e++){var f=game.isWidescreen?0:getRandom(1,7),g=a[e],h=this.marbleMenu[e],i=this.marbleShadows[e];h.x=g.x+b,h.y=g.y+c+f,i.x=h.x-h.getBounds().width/2,i.y=h.y+h.getBounds().height/2}},a.abcya.MarbleDragCounter=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.bg=null,b.prototype.lblNum=null,b.prototype.num=null,b.prototype.initialize=function(){this.Container_initialize(),this.bg=new createjs.Sprite(game.assets.mathsheet,"ChoiceBg"),this.addChild(this.bg),this.lblNum=new createjs.Text("X","bold 42pt vagrounded_btregular","#0071BC"),this.lblNum.textAlign="center",this.lblNum.textBaseline="center",this.lblNum.x=this.bg.getBounds().width/2,this.lblNum.y=this.bg.getBounds().height/2+22,this.addChild(this.lblNum),this.on("mousedown",this.onClick,this)},b.prototype.setChoice=function(a){this.num=a,this.lblNum.text=a.toString(),this.reset()},b.prototype.onClick=function(a){var b=new createjs.Event("CHOICE_SELECT");b.objData=this.num,this.dispatchEvent(b)},b.prototype.showIncorrect=function(){createjs.Tween.get(this,{override:!0}).to({alpha:0},100,createjs.Ease.quadOut)},b.prototype.reset=function(){this.alpha=0,createjs.Tween.get(this,{override:!0}).to({alpha:1},1600,createjs.Ease.quadOut)},a.abcya.QuestionChoice=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.bg=null,b.prototype.lblQuestion=null,b.prototype.lblNum1=null,b.prototype.lblPlus=null,b.prototype.lblNum2=null,b.prototype.lblNumQMark=null,b.prototype.choiceContainer=null,b.prototype.choiceDisplays=[],b.prototype.correctSounds=["CorrectSound","RadicalSound","SweetSound","GotItSound","GroovySound","AwesomeSound"],b.prototype.higherSounds=["MoreThanSound","TooLittleSound"],b.prototype.lowerSounds=["LessThanSound","TooMuchSound"],b.prototype.sentenceQueue=[],b.prototype.currentSentencePart=null,b.prototype.feedbackSound=null,b.prototype.currentSound=null,b.prototype.currentInfo={answer:null,num1:null,num2:null,incorrects:0},b.prototype.roundData=[],b.prototype.currentQuestion=0,b.prototype.isEnabled=!0,b.prototype.initialize=function(){this.Container_initialize(),this.roundData=[],this.choiceDisplays=[],this.currentQuestion=0,this.isEnabled=!1,this.bg=new createjs.Sprite(game.assets.mathsheet,"QuestionBubble"),this.addChild(this.bg);var a=24;this.lblQuestion=new createjs.Text("How many is ","32pt vagrounded_btregular","#000"),this.lblQuestion.x=30,this.lblQuestion.y=a,this.addChild(this.lblQuestion),this.lblNum1=new createjs.Text("Num1","32pt vagrounded_btregular","#C1272D"),this.lblNum1.y=a,this.addChild(this.lblNum1),this.lblPlus=new createjs.Text("plus","32pt vagrounded_btregular","#000"),this.lblPlus.y=a,this.addChild(this.lblPlus),this.lblNum2=new createjs.Text("Num2","32pt vagrounded_btregular","#C1272D"),this.lblNum2.y=a,this.addChild(this.lblNum2),this.lblNumQMark=new createjs.Text("?","32pt vagrounded_btregular","#000"),this.lblNumQMark.y=a,this.addChild(this.lblNumQMark),this.choiceContainer=new createjs.Container;for(var b=0;b<3;b++){var c=new abcya.QuestionChoice;c.x=150*b,c.on("CHOICE_SELECT",this.handleChoiceClick,this),this.choiceDisplays.push(c),this.choiceContainer.addChild(c)}this.choiceContainer.y=130,this.choiceContainer.x=110,this.addChild(this.choiceContainer)},b.prototype.initQuestion=function(){this.currentQuestion++;var a=5*game.gameData.currentRound,b=getRandom(1,a),c=getRandom(1,b),d=b-c,e=10;this.currentInfo={answer:b,num1:c,num2:d,incorrects:0,questionNum:this.currentQuestion};var f=110;this.lblQuestion.text="How many is",this.lblQuestion.x=f,this.lblNum1.text=this.currentInfo.num1.toString(),this.lblNum1.x=this.lblQuestion.x+this.lblQuestion.getBounds().width+e,this.lblPlus.text="plus",this.lblPlus.x=this.lblNum1.x+this.lblNum1.getBounds().width+e,this.lblNum2.text=this.currentInfo.num2.toString(),this.lblNum2.x=this.lblPlus.x+this.lblPlus.getBounds().width+e,this.lblNumQMark.text="?",this.lblNumQMark.x=this.lblNum2.x+this.lblNum2.getBounds().width+e,this.sentenceQueue=["HowManySound","Sound"+c,"PlusSound","Sound"+d];for(var g,h=[b];h.length<3;)g=getRandom(1,a),h.indexOf(g)==-1&&h.push(g);for(var i=shuffleArray(h),j=this.choiceDisplays.length,k=0;k<j;k++){var l=i[k];this.choiceDisplays[k].setChoice(l)}this.isEnabled=!0;var m=new createjs.Event("INIT_QUESTION");m.objData=this.currentQuestion,this.dispatchEvent(m),this.playSentencePart()},b.prototype.handleChoiceClick=function(a){if(this.isEnabled)if(this.currentSound&&(this.currentSound.removeAllEventListeners(),this.currentSound.stop()),this.currentSound=null,this.currentSentencePart=null,this.sentenceQueue=[],a.objData==this.currentInfo.answer)if(this.roundData.push(this.currentInfo),this.isEnabled=!1,this.currentSound=this.feedbackSound=createjs.Sound.play(this.correctSounds[getRandom(0,this.correctSounds.length-1)]),this.currentQuestion<abcya.GameConfig.ROUND_QUESTION_COUNT){var b=new createjs.Event("SUBMIT_QUESTION");b.objData=this.currentInfo,this.dispatchEvent(b),this.feedbackSound.on("complete",this.initQuestion,this)}else{var b=new createjs.Event("SUBMIT_ROUND");b.objData=this.roundData,this.dispatchEvent(b)}else{a.target.showIncorrect();var b=new createjs.Event("INCORRECT_ANSWER");this.dispatchEvent(b),a.objData>this.currentInfo.answer?createjs.Sound.play(this.lowerSounds[getRandom(0,1)]):createjs.Sound.play(this.higherSounds[getRandom(0,1)]),this.currentInfo.incorrects++}},b.prototype.playSentencePart=function(){if(this.sentenceQueue.length>0){var a=this.sentenceQueue.shift();this.currentSound=this.currentSentencePart=createjs.Sound.play(a),this.currentSentencePart.on("complete",this.playSentencePart,this)}else this.currentSound=null},b.prototype.stopSounds=function(){this.currentSound&&(this.currentSound.removeAllEventListeners(),this.currentSound.stop()),this.currentSound=null,this.currentSentencePart=null,this.sentenceQueue=[]},a.abcya.QuestionDisplay=b}(window),function(a){function b(a,b,c,d){this.initialize(a,b,c,d)}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.txt=null,b.prototype.mark=null,b.prototype.isCorrect=null,b.prototype.initialize=function(a,b,c,d){this.Container_initialize(),this.x=a,this.y=b,this.isCorrect=d,this.txt=new createjs.Text(c,"18pt comic_sans_msregular","#000"),this.addChild(this.txt);var e=d?"CorrectMark":"IncorrectaMark";this.mark=new createjs.Sprite(game.assets.mathsheet,e),d?(this.mark.x=this.txt.getBounds().width,this.mark.y=5):(this.mark.x=this.txt.getBounds().width+5,this.mark.y=10),this.mark.alpha=0,this.addChild(this.mark)},b.prototype.showMark=function(b){a.setTimeout(this.doTweenIn.bind(this),b)},b.prototype.doTweenIn=function(){createjs.Tween.get(this.mark).to({alpha:1},400).call(this.playSound.bind(this));var a=a=this.isCorrect?"CorrectMarkSound":"IncorrectMarkSound";createjs.Sound.play(a)},b.prototype.playSound=function(a){},b.prototype.getTextWidth=function(){return this.txt.getBounds().width},b.prototype.setMarkX=function(a){this.isCorrect||(a+=5),a+=2,this.mark.x=a},a.abcya.ResultItem=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.bg=null,b.prototype.roundNumDisplay=null,b.prototype.indicators=null,b.curIndicatorIndex=-1,b.prototype.initialize=function(){this.Container_initialize(),this.bg=new createjs.Sprite(game.assets.mathsheet,"QuestionIndicatorBg"),this.bg.y=-10,this.addChild(this.bg),this.indicators=[];var a,b,c=10;for(a=0;a<c;a++)b=new createjs.Sprite(game.assets.mathsheet,"QuestionIndicatorFuture"),b.x=20*a+50,b.y=25,this.indicators.push(b),this.addChild(b);this.roundNumDisplay=new createjs.Text("Round "+game.gameData.currentRound,"18pt vagrounded_btregular","#BC3F3F"),this.roundNumDisplay.textAlign="center",this.roundNumDisplay.x=150,this.roundNumDisplay.y=40,this.addChild(this.roundNumDisplay)},b.prototype.nextQuestion=function(a){this.curIndicatorIndex>=0&&this.indicators[this.curIndicatorIndex].gotoAndPlay("QuestionIndicatorPast"),this.curIndicatorIndex=a-1,this.indicators[this.curIndicatorIndex].gotoAndPlay("QuestionIndicatorPresent")},a.abcya.RoundIndicator=b}(window),function(a){function b(a,b,c){this.initialize(a,b)}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.button=null,b.prototype.lock=null,b.prototype.isLocked=!0,b.prototype.roundNum=null,b.prototype.initialize=function(a,b){this.Container_initialize(),this.roundNum=b,this.button=new createjs.Sprite(game.assets.mathsheet,a),this.addChild(this.button),b>game.gameData.lastRoundUnlocked?(this.lock=new createjs.Sprite(game.assets.animationsheet,"locked"),this.lock.x=this.button.getBounds().width/2+this.lock.getBounds().width/2,this.lock.y=this.button.getBounds().height/2-this.lock.getBounds().height/2,b>5&&(this.lock.x=this.lock.x+10,this.lock.y=this.lock.y+10),this.addChild(this.lock)):this.isLocked=!1},b.prototype.unlock=function(){this.isLocked&&(this.lock.gotoAndPlay("opening"),this.isLocked=!1,createjs.Sound.play("LevelUpSound"))},a.abcya.RoundSelectButton=b}(window),function(a){function b(a){this.initialize(a)}a.abcya=a.abcya||{},b.prototype=new createjs.Sprite,b.prototype.Sprite_initialize=b.prototype.initialize,b.prototype.marbleType=null,b.prototype.origX=null,b.prototype.origY=null,b.prototype.body=null,b.prototype.isGrabbed=!1,b.prototype.grabbedMarbleRef=null,b.prototype.offsetX=0,b.prototype.offsetY=0,b.prototype.initialize=function(a){this.marbleType=a,this.Sprite_initialize(game.assets.commonsheet,"Marble"+a)},b.prototype.startDragging=function(a,b){this.x=a,this.y=b,this.origX=a+this.getBounds().width/2,this.origY=b+this.getBounds().height/2,createjs.Tween.get(this).to({scaleX:2,scaleY:2},100,createjs.Ease.quadOut)},b.prototype.stopDragging=function(){this.scaleX=1,this.scaleY=1},a.abcya.MarbleDisplay=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.bg=null,b.prototype.animatedMarbles=null,b.prototype.penguinContainer=null,b.prototype.btnGo=null,b.prototype.penguin=null,b.prototype.tempText1=null,b.prototype.tempText2=null,b.prototype.active=!0,b.prototype.initialize=function(){this.Container_initialize(),this.tempText1=new createjs.Text(".","18pt comic_sans_msregular","#000"),this.addChild(this.tempText1),this.tempText1.alpha=.01,this.tempText2=new createjs.Text(".","bold 32pt vagrounded_btregular","#000"),this.addChild(this.tempText2),this.tempText2.alpha=.01,game.sceneManager.currentBg="IntroBackground",game.sceneManager.setBg(),this.btnGo=new createjs.Sprite(game.assets.commonsheet,"BtnGo"),this.btnGo.scaleX=1,this.btnGo.scaleY=1,this.btnGo.on("click",this.goClick,this),this.btnGo.x=game.screen_width+80,this.btnGo.y=game.screen_height-180,this.addChild(this.btnGo),this.layoutRatio();var a=game.screen_width/2-this.btnGo.getBounds().width/2-15;createjs.Tween.get(this.btnGo).to({x:a},800,createjs.Ease.quadOut).call(this.handleGoReady.bind(this)),game.bgMusic=createjs.Sound.play("ThemeSound",createjs.Sound.INTERRUPT_ANY,0,0,-1)},b.prototype.makeMarbles=function(){this.animatedMarbles=[];for(var a=[{x:100,y:400,type:1,speed:1200},{x:155,y:470,type:2,speed:1520},{x:250,y:420,type:3,speed:1500},{x:312,y:540,type:4,speed:1480},{x:700,y:520,type:5,speed:1380},{x:810,y:475,type:1,speed:1250},{x:900,y:540,type:3,speed:1600}],b=a.length,c=0;c<b;c++){var d=new abcya.MarbleDisplay(a[c].type),e=new createjs.Container,f=new createjs.Sprite(game.assets.commonsheet,"MarbleShadow");f.x=-18,f.y=d.getBounds().height/2+10,e.addChild(f),e.addChild(d),e.x=game.screen_width+50,e.y=a[c].y-20,this.addChild(e),this.animatedMarbles.push(e),createjs.Tween.get(e).to({x:a[c].x},a[c].speed,createjs.Ease.quadOut)}},b.prototype.handleGoReady=function(a){this.active&&createjs.Sound.play("marbleDropTitleSound")},b.prototype.goClick=function(a){this.btnGo.removeAllEventListeners(),this.removeChild(this.tempText1),this.tempText1=null,this.removeChild(this.tempText2),this.tempText2=null,this.active=!1,createjs.Tween.get(this).to({alpha:0},350,createjs.Ease.quadOut).call(this.introFinished.bind(this))},b.prototype.introFinished=function(){this.dispatchEvent(abcya.GameStateEvents.GE_GO_CLICK)},b.prototype.layoutRatio=function(){game.isWidescreen?this.btnGo.y=game.screen_height-180:this.btnGo.y=game.screen_height-180},a.abcya.DropIntroScreen=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.bg=null,b.prototype.penguinContainer=null,b.prototype.penguin=null,b.prototype.penguinShadow=null,b.prototype.questionDisplay=null,b.prototype.marbleCounter=null,b.prototype.btnHelp=null,b.prototype.helpOverlay=null,b.prototype.roundIndicator=null,b.prototype.currentSound=null,b.prototype.initialize=function(){this.Container_initialize(),game.sceneManager.currentBg="GameBackground",game.sceneManager.setBg(),createjs.Sound.stop(),this.questionDisplay=new abcya.QuestionDisplay,this.questionDisplay.scaleX=.85,this.questionDisplay.scaleY=.85,this.questionDisplay.x=game.screen_width/2-this.questionDisplay.bg.getBounds().width/2+60,this.questionDisplay.y=100,this.questionDisplay.on("INIT_QUESTION",this.questionInitialized,this),this.questionDisplay.on("SUBMIT_ROUND",this.roundFinished,this),this.questionDisplay.on("SUBMIT_QUESTION",this.questionSubmitted,this),this.questionDisplay.on("INCORRECT_ANSWER",this.disappointPenguin,this),this.marbleCounter=new abcya.MarbleDragCounter,this.marbleCounter.x=210,this.marbleCounter.y=320,this.addChild(this.marbleCounter),this.penguinContainer=new createjs.Container,this.penguinShadow=new createjs.Sprite(game.assets.mathsheet,"RoundSelectPenguinShadow"),this.penguinShadow.x=0,this.penguinContainer.addChild(this.penguinShadow),this.penguin=new createjs.Sprite(game.assets.animationsheet,"game idle"),this.penguinContainer.x=178,this.penguinContainer.y=125,this.penguinShadow.x=this.penguin.x-this.penguin.getBounds().width+35,this.penguinShadow.scaleX=.9,this.penguinShadow.y=this.penguin.y+this.penguin.getBounds().height-46,this.penguinContainer.addChild(this.penguin),this.addChild(this.penguinContainer),this.roundIndicator=new abcya.RoundIndicator,this.roundIndicator.x=game.screen_width/2-this.roundIndicator.bg.getBounds().width/2,this.roundIndicator.y=-10,this.addChild(this.roundIndicator),this.btnHelp=new createjs.Sprite(game.assets.commonsheet,"BtnHelp"),this.addChild(this.btnHelp),this.btnHelp.x=game.screen_width-this.btnHelp.getBounds().width-90,this.btnHelp.y=20,this.btnHelp.on("mousedown",this.showHelp,this),this.helpOverlay=new abcya.HelpOverlay("HelpDisplay_normal"),this.helpOverlay.alpha=.1,game.bgMusic=null,this.addChild(this.marbleCounter),game.gameData.showedHelped?(this.questionDisplay.initQuestion(),this.addChild(this.questionDisplay,this.marbleCounter)):(game.gameData.showedHelped=!0,this.addChild(this.helpOverlay),createjs.Tween.get(this.helpOverlay).to({alpha:1},1200,createjs.Ease.quadOut),this.helpOverlay.on("mousedown",this.firstHelpClick,this),this.currentSound=createjs.Sound.play("InstSound")),this.layoutRatio()},b.prototype.firstHelpClick=function(){this.helpOverlay.removeAllEventListeners(),createjs.Tween.get(this.helpOverlay,{override:!0}).to({alpha:0},600,createjs.Ease.quadOut),this.questionDisplay.initQuestion(),this.addChild(this.questionDisplay),this.currentSound.stop(),this.currentSound=null},b.prototype.showHelp=function(){this.addChild(this.helpOverlay),createjs.Tween.get(this.helpOverlay,{override:!0}).to({alpha:1},600,createjs.Ease.quadOut),this.helpOverlay.on("mousedown",this.hideHelp,this),this.questionDisplay.stopSounds(),this.currentSound=createjs.Sound.play("InstSound")},b.prototype.hideHelp=function(a){this.helpOverlay.removeAllEventListeners(),createjs.Tween.get(this.helpOverlay,{override:!0}).to({alpha:0},600,createjs.Ease.quadOut)},b.prototype.questionInitialized=function(a){this.roundIndicator.nextQuestion(a.objData)},b.prototype.roundFinished=function(a){this.marbleCounter.reset(),createjs.Tween.get(this).wait(30).to({alpha:0},600).call(this.forreal),game.gameData.roundResults[game.gameData.currentRound-1]=a.objData},b.prototype.forreal=function(a){this.destroy(),this.dispatchEvent(abcya.GameStateEvents.GE_SHOW_RESULTS)},b.prototype.tick=function(a){game.hasFocus&&this.marbleCounter.tick(a)},b.prototype.disappointPenguin=function(a){this.penguin.gotoAndPlay("incorrect")},b.prototype.questionSubmitted=function(a){this.marbleCounter.reset(),this.penguin.gotoAndPlay("correct")},b.prototype.layoutRatio=function(){var a=game.isWidescreen?.9:1.4;this.penguinContainer.scaleX=a*-1,this.penguinContainer.scaleY=a;var b=game.isWidescreen?178:210;this.penguinContainer.x=b,this.marbleCounter.layoutRatio();var c=game.isWidescreen?game.screen_height-this.marbleCounter.getBounds().height-30:game.screen_height-this.marbleCounter.getBounds().height+100;this.marbleCounter.y=c,this.helpOverlay.layoutRatio(game.isWidescreen)},b.prototype.destroy=function(){this.removeChild(this.bg),this.bg=null,this.removeChild(this.penguin),this.penguin=null,this.removeChild(this.questionDisplay),this.questionDisplay=null,this.removeChild(this.marbleCounter),this.marbleCounter=null,this.removeChild(this.helpOverlay),this.helpOverlay=null,this.removeChild(this.roundIndicator),this.roundIndicator=null},a.abcya.GameScreen=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.bg=null,b.prototype.animatedMarbles=null,b.prototype.penguinContainer=null,b.prototype.btnGo=null,b.prototype.penguin=null,b.prototype.tempText1=null,b.prototype.tempText2=null,b.prototype.active=!0,b.prototype.initialize=function(){this.Container_initialize(),this.tempText1=new createjs.Text(".","18pt comic_sans_msregular","#000"),this.addChild(this.tempText1),this.tempText1.alpha=.01,this.tempText2=new createjs.Text(".","bold 32pt vagrounded_btregular","#000"),this.addChild(this.tempText2),this.tempText2.alpha=.01,game.sceneManager.currentBg="IntroBackground",game.sceneManager.setBg(),this.penguinContainer=new createjs.Container,this.penguin=new createjs.Sprite(game.assets.animationsheet,"intro run"),this.btnGo=new createjs.Sprite(game.assets.commonsheet,"BtnGo"),this.btnGo.scaleX=1,this.btnGo.scaleY=1,this.btnGo.on("click",this.goClick,this),this.btnGo.x=10,this.btnGo.y=this.penguin.getBounds().height,this.penguinContainer.addChild(this.btnGo),this.penguinContainer.addChild(this.penguin),this.addChild(this.penguinContainer),this.makeMarbles(),this.penguinContainer.alpha=0,this.layoutRatio(),createjs.Tween.get(this).wait(10).call(this.startIntro,null,this),game.bgMusic=createjs.Sound.play("ThemeSound",createjs.Sound.INTERRUPT_ANY,0,0,-1)},b.prototype.startIntro=function(){this.layoutRatio(),this.penguinContainer.alpha=1,this.penguinContainer.x=game.screen_width+500;var a=game.screen_width/2-this.btnGo.getBounds().width/2;createjs.Tween.get(this.penguinContainer).to({x:a},2200,createjs.Ease.quadOut).call(this.handleGoReady.bind(this));for(var b=[{x:100,y:400,type:1,speed:1200},{x:155,y:470,type:2,speed:1520},{x:250,y:420,type:3,speed:1500},{x:312,y:540,type:4,speed:1480},{x:700,y:520,type:5,speed:1380},{x:810,y:475,type:1,speed:1250},{x:900,y:540,type:3,speed:1600}],c=b.length,d=0;d<c;d++){var e=this.animatedMarbles[d];e.x=game.screen_width+50,e.y=b[d].y-20,createjs.Tween.get(e).to({x:b[d].x},b[d].speed,createjs.Ease.quadOut)}},b.prototype.makeMarbles=function(){this.animatedMarbles=[];for(var a=[{x:100,y:400,type:1,speed:1200},{x:155,y:470,type:2,speed:1520},{x:250,y:420,type:3,speed:1500},{x:312,y:540,type:4,speed:1480},{x:700,y:520,type:5,speed:1380},{x:810,y:475,type:1,speed:1250},{x:900,y:540,type:3,speed:1600}],b=a.length,c=0;c<b;c++){var d=new abcya.MarbleDisplay(a[c].type),e=new createjs.Container,f=new createjs.Sprite(game.assets.commonsheet,"MarbleShadow");f.x=-18,f.y=d.getBounds().height/2+10,e.addChild(f),e.addChild(d),e.x=game.screen_width+50,e.y=a[c].y-20,this.addChild(e),this.animatedMarbles.push(e),createjs.Tween.get(e).to({x:a[c].x},a[c].speed,createjs.Ease.quadOut)}},b.prototype.handleGoReady=function(a){this.active&&(this.penguin.gotoAndPlay("intro idle"),createjs.Sound.play("MarbleMathSound"))},b.prototype.goClick=function(a){this.btnGo.removeAllEventListeners(),this.removeChild(this.tempText1),this.tempText1=null,this.removeChild(this.tempText2),this.tempText2=null,this.active=!1,createjs.Tween.get(this).to({alpha:0},350,createjs.Ease.quadOut).call(this.introFinished.bind(this));
},b.prototype.introFinished=function(){this.dispatchEvent(abcya.GameStateEvents.GE_GO_CLICK)},b.prototype.layoutRatio=function(){var a=0;a=game.isWidescreen?52:120,this.penguinContainer.y=game.screen_height-this.penguinContainer.getBounds().height-a;for(var b=this.animatedMarbles.length,c=0;c<b;c++){var d=this.animatedMarbles[c],e=getRandom(50,150);d.y=game.screen_height-d.getBounds().height-e}},a.abcya.IntroScreen=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.penguin=null,b.prototype.penguinRunSound=null,b.prototype.gameControls=null,b.prototype.lastMarbleSpawnTime=0,b.prototype.marbleSpawnWaiter=800,b.prototype.gimmeCount=0,b.prototype.marbles=[],b.prototype.collectedMarbles=[],b.prototype.marbleTrash=[],b.prototype.equationContainer=null,b.prototype.equationMarbles=[],b.prototype.equationSymbols=[],b.prototype.equationTotalLabel=null,b.prototype.equationCounter=0,b.prototype.currentAddMarble=null,b.prototype.hud=null,b.prototype.tooMuchText=null,b.prototype.strikeWarningText=null,b.prototype.btnHelp=null,b.prototype.helpOverlay=null,b.prototype.helpSound=null,b.prototype.btnAdd=null,b.prototype.btnDrop=null,b.prototype.active=!0,b.prototype.score=0,b.prototype.goalNumber=3,b.prototype.submittedNumber=null,b.prototype.correctCount=0,b.prototype.incorrectCount=0,b.prototype.paused=!1,b.prototype.initialize=function(){this.Container_initialize(),this.marbleSpawnWaiter=abcya.GameConfig.MARBLE_SPAWNTIME,this.marbles=[],this.collectedMarbles=[],this.marbleTrash=[],this.equationMarbles=[],this.equationSymbols=[],game.sceneManager.currentBg="DropBackground",game.sceneManager.setBg(),this.penguin=new abcya.PenguinDropChar,this.penguin.y=game.screen_height-this.penguin.getBounds().height-58,this.penguin.x=50,this.addChild(this.penguin),this.gameControls=new abcya.GameScreenKeyControls,this.gameControls.x=0,this.gameControls.y=0,this.gameControls.on("CONTROL_INPUT",this.handleControlInput,this),this.gameControls.on("STOP_PENGUIN",this.handleStopPenguin,this),this.addChild(this.gameControls),this.hud=new abcya.DropHUD,this.hud.y=10,this.addChild(this.hud),this.tooMuchText=new createjs.Text("That's too many marbles!","bold 42pt vagrounded_btregular","#4B4B4B"),this.tooMuchText.x=game.screen_width/2-this.tooMuchText.getBounds().width/2,this.tooMuchText.y=game.screen_height/2-this.tooMuchText.getBounds().height/2,this.tooMuchText.alpha=0,this.addChild(this.tooMuchText),this.strikeWarningText=new createjs.Text("Strike: 0","bold 42pt vagrounded_btregular","#4B4B4B"),this.strikeWarningText.x=game.screen_width/2-this.strikeWarningText.getBounds().width/2,this.strikeWarningText.y=game.screen_height/2-this.strikeWarningText.getBounds().height/2-80,this.strikeWarningText.alpha=0,this.addChild(this.strikeWarningText),this.btnAdd=new createjs.Sprite(game.assets.dropsheet,"BtnAdd"),this.btnAdd.x=game.screen_width-this.btnAdd.getBounds().width-30,this.btnAdd.y=130,this.btnAdd.on("mousedown",this.submitMarbles,this);var a=new createjs.Shape,b=a.graphics;b.beginFill(createjs.Graphics.getRGB(24,155,155,1)),b.drawRect(0,0,this.btnAdd.getBounds().width,this.btnAdd.getBounds().height,0),this.btnAdd.hitArea=a,this.addChild(this.btnAdd),this.btnDrop=new createjs.Sprite(game.assets.dropsheet,"BtnMinus"),this.btnDrop.x=30,this.btnDrop.y=130,this.btnDrop.on("mousedown",this.dropMarbles,this);var a=new createjs.Shape,b=a.graphics;b.beginFill(createjs.Graphics.getRGB(24,155,155,1)),b.drawRect(0,0,this.btnDrop.getBounds().width,this.btnDrop.getBounds().height,0),this.btnDrop.hitArea=a,this.addChild(this.btnDrop),this.btnHelp=new createjs.Sprite(game.assets.commonsheet,"BtnHelp"),this.btnHelp.x=game.screen_width-this.btnHelp.getBounds().width-90,this.btnHelp.y=20,this.btnHelp.on("mousedown",this.showHelp,this),this.addChild(this.btnHelp),this.helpOverlay=new abcya.DropHelpOverlay,this.helpOverlay.on("mousedown",this.hideHelp,this),this.showHelp(),this.penguinRunSound=createjs.Sound.play("penguinRunSound",createjs.Sound.INTERRUPT_ANY,0,0,-1),this.penguinRunSound.paused=!0,this.initNumber()},b.prototype.initNumber=function(){this.goalNumber=getRandom(2,abcya.GameConfig.MAX_MARBLE_VALUE),this.hud.goalText.text=this.goalNumber},b.prototype.handleControlInput=function(a){if(this.active&&a.objData)switch(a.objData){case abcya.GameConfig.KEY_LEFT:this.penguin.setVelocity(-1),this.penguinRunSound.paused=!1;break;case abcya.GameConfig.KEY_RIGHT:this.penguin.setVelocity(1),this.penguinRunSound.paused=!1;break;case abcya.GameConfig.KEY_SUBMIT:this.submitMarbles();break;case"STOP_PENGUIN":this.penguinRunSound.paused=!0,this.penguin.setVelocity(0)}},b.prototype.handleStopPenguin=function(a){this.penguin.setVelocity(0)},b.prototype.spawnMarble=function(){var a=abcya.GameConfig.MAX_MARBLE_VALUE;this.gimmeCount>4?(a=this.goalNumber,this.gimmeCount=0):this.gimmeCount++;var b=new abcya.DroppingMarble(a);b.x=getRandom(85,game.screen_width-120),b.y=-40,this.marbles.push(b),this.addChild(b)},b.prototype.collectMarble=function(a){var b=this.collectedMarbles.length<3?this.collectedMarbles.length:this.collectedMarbles.length%3,c=Math.floor(this.collectedMarbles.length/3);a.x=30*b,a.y=c*-30,this.removeChild(a),this.penguin.basketContainer.addChild(a),this.collectedMarbles.push(a),createjs.Sound.play("PlacedSound"),this.checkForTooMuch()},b.prototype.dropMarbles=function(){createjs.Sound.play("RemovedSound"),this.penguin.dropMarbles();for(var a in this.collectedMarbles){var b=this.collectedMarbles[a],c=this.penguin.localToGlobal(b.x,b.y);this.penguin.basketContainer.removeChild(b),this.addChild(b),b.x=c.x+70,b.y=c.y,createjs.Tween.get(b).to({x:b.x-160,y:game.screen_height+50},500).call(this.destroyMarble,!1,this),this.marbleTrash.push(b)}this.collectedMarbles=[]},b.prototype.destroyMarble=function(a){var b=this.marbleTrash.indexOf(a.target);this.marbleTrash.splice(b,1),this.removeChild(a.target)},b.prototype.checkForTooMuch=function(){for(var a=this.collectedMarbles.length,b=0,c=0;c<a;c++)b+=this.collectedMarbles[c].numValue;b>this.goalNumber&&(this.incorrectCount++,this.dropMarbles(),createjs.Tween.get(this.tooMuchText,{override:!0}).to({alpha:1},400).call(this.handleTooMuchWait,!1,this),this.strikeWarningText.text="Strike: "+this.incorrectCount,createjs.Tween.get(this.strikeWarningText,{override:!0}).to({alpha:1},400).call(this.fadeOutStrike,!1,this))},b.prototype.handleTooMuchWait=function(a){this.checkGameOver(!0),createjs.Tween.get(this.tooMuchText,{override:!0}).wait(1e3).to({alpha:0},400)},b.prototype.submitMarbles=function(){if(!(this.collectedMarbles.length<=0)){this.dimMarbles(.2),this.paused=!0,createjs.Sound.play("SlideWhistleSound"),this.active=!1,this.submittedNumber=0,this.equationContainer=new createjs.Container;for(var a,b,c,d,e=5,f=0,g=0,h=this.collectedMarbles.length,i=0;i<h;i++){g++;var j=this.collectedMarbles[i];this.submittedNumber+=j.numValue;var k=this.penguin.localToGlobal(j.x,j.y);this.penguin.basketContainer.removeChild(j),j.on("MARBLE_ADDED_ANIMATION_OVER",this.addMarbles,this),this.equationMarbles.push(j),this.equationContainer.addChild(j),j.x=k.x+70,j.y=k.y,a=110*g,b=60*f,j.setupForEquation(),createjs.Tween.get(j).to({x:a+17,y:b+17},400),d=i<h-1?"DropPlus":"DropEquals",c=new createjs.Sprite(game.assets.dropsheet,d),a+=60,c.x=a,c.y=b,this.equationContainer.addChild(c),this.equationSymbols.push(c),g>=e&&(g=0,f++)}this.equationCounter=0,this.equationTotalLabel=new createjs.Text("","bold 36pt vagrounded_btregular","#FFF"),this.equationTotalLabel.x=a+60,this.equationTotalLabel.y=b-15,this.equationContainer.addChild(this.equationTotalLabel);var l="";l=this.goalNumber==this.submittedNumber?"DropCorrectMark":"DropIncorrectMark",this.equationMark=new createjs.Sprite(game.assets.dropsheet,l),this.equationMark.alpha=0,this.equationMark.x=this.equationTotalLabel.x+60,this.equationMark.y=this.equationTotalLabel.y+12,this.equationContainer.addChild(this.equationMark),this.equationContainer.x=100,this.equationContainer.y=120,this.addChild(this.equationContainer),this.collectedMarbles=[],this.currentAddMarble=0,createjs.Tween.get(this).wait(400).call(this.addMarbles,!1,this)}},b.prototype.addMarbles=function(){this.currentAddMarble<this.equationMarbles.length?(this.equationCounter+=this.equationMarbles[this.currentAddMarble].numValue,this.equationTotalLabel.text=this.equationCounter,this.equationMarbles[this.currentAddMarble].pulse(),this.currentAddMarble++):(createjs.Tween.get(this.equationMark).to({alpha:1},400).call(this.addingComplete,!1,this),this.submittedNumber==this.goalNumber?(this.score+=this.submittedNumber,this.hud.scoreText.text=this.score,this.correctCount++,createjs.Sound.play("LevelUpSound")):(this.incorrectCount++,createjs.Sound.play("IncorrectMarkSound")))},b.prototype.addingComplete=function(){createjs.Tween.get(this.equationMark).wait(1e3).to({alpha:1},400).call(this.destroyEquation,!1,this)},b.prototype.destroyEquation=function(){this.paused=!1,this.dimMarbles(1),this.equationContainer.removeAllChildren(),this.equationMarbles=[],this.equationSymbols=[],this.checkGameOver(!0)||(this.goalNumber==this.submittedNumber?(this.submittedNumber=0,this.initNumber()):(this.strikeWarningText.text="Strike: "+this.incorrectCount,createjs.Tween.get(this.strikeWarningText,{override:!0}).to({alpha:1},400).call(this.fadeOutStrike,!1,this)),this.active=!0)},b.prototype.showHelp=function(){this.addChild(this.helpOverlay),this.helpOverlay.alpha=1,this.helpSound=createjs.Sound.play("marbleDropInstructionsSound"),this.paused=!0},b.prototype.hideHelp=function(){this.removeChild(this.helpOverlay),this.helpSound.stop(),this.paused=!1},b.prototype.checkGameOver=function(a){var b=!1;return this.incorrectCount>=3&&(1==a&&this.doGameOver(),b=!0),b},b.prototype.fadeOutStrike=function(){createjs.Tween.get(this.strikeWarningText,{override:!0}).wait(800).to({alpha:0},400)},b.prototype.doGameOver=function(){this.strikeWarningText.text="Strike: "+this.incorrectCount,createjs.Tween.get(this.strikeWarningText,{override:!0}).to({alpha:1},800).call(this.reallyDoGameOver,!1,this)},b.prototype.reallyDoGameOver=function(){var a={score:this.score,correct:this.correctCount,incorrect:this.incorrectCount};game.gameData.dropData=a,this.destroy(),this.dispatchEvent(abcya.GameStateEvents.GE_SHOW_MARBLE_DROP_RESULTS)},b.prototype.dimMarbles=function(a){for(var b=this.marbles.length-1,c=b;c>=0;c--){var d=this.marbles[c];d.alpha=a}},b.prototype.checkCollision=function(a,b){var c=!1,d=a.getBounds(),e=b.getBounds(),f=a.parent.localToGlobal(a.x,a.y);f.x+=35;var g=f.x-b.x,h=d.width/2+e.width/2;if(h=h,g>-h&&g<h){var i=f.y-b.y,j=d.height/2+e.height/2;j=j,i>-j&&i<j&&(c=!0)}return c},b.prototype.tick=function(a){if(!this.paused){this.penguin.tick(a);for(var b=this.marbles.length-1,c=b;c>=0;c--){var d=this.marbles[c];if(d.y>300&&this.active){var e=this.checkCollision(this.penguin.basketHit,d);if(e){this.marbles.splice(c,1),this.removeChild(d),this.collectMarble(d);continue}d.tick(a)}else d.tick(a);d.y>=game.screen_height-30&&(this.marbles.splice(c,1),this.marbleTrash.push(d),createjs.Tween.get(d).to({alpha:0},400).call(this.destroyMarble,!1,this))}a.time-this.lastMarbleSpawnTime>this.marbleSpawnWaiter&&(this.spawnMarble(),this.lastMarbleSpawnTime=a.time)}},b.prototype.layoutRatio=function(){var a=game.isWidescreen?38:58;this.penguin.y=game.screen_height-this.penguin.getBounds().height-a,this.gameControls.layoutRatio(),this.tooMuchText.y=game.screen_height/2-this.tooMuchText.getBounds().height/2,this.strikeWarningText.y=game.screen_height/2-this.strikeWarningText.getBounds().height/2-80},b.prototype.destroy=function(){},a.abcya.MarbleDrop=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.lblCorrect=null,b.prototype.lblIncorrect=null,b.prototype.lblScore=null,b.prototype.btnBack=null,b.prototype.initialize=function(){this.Container_initialize(),game.sceneManager.currentBg="DropResultsBackground",game.sceneManager.setBg(),this.lblCorrect=new createjs.Text(game.gameData.dropData.correct.toString(),"18pt vagrounded_btregular","#FFF"),this.lblCorrect.textAlign="center",this.lblCorrect.x=478,this.lblCorrect.y=107,this.addChild(this.lblCorrect),this.lblIncorrect=new createjs.Text(game.gameData.dropData.incorrect.toString(),"18pt vagrounded_btregular","#FFF"),this.lblIncorrect.textAlign="center",this.lblIncorrect.x=478,this.lblIncorrect.y=225,this.addChild(this.lblIncorrect),this.lblScore=new createjs.Text(game.gameData.dropData.score.toString(),"bold 64pt vagrounded_btregular","#2882A5"),this.lblScore.textAlign="center",this.lblScore.x=478,this.lblScore.y=410,this.addChild(this.lblScore),this.btnBack=new createjs.Sprite(game.assets.dropsheet,"BtnBackWithShadow"),this.btnBack.x=20,this.btnBack.y=500,this.btnBack.on("mousedown",this.onBackClick,this),this.addChild(this.btnBack),createjs.Sound.play("SlideWhistleSound"),game.bgMusic||(game.bgMusic=createjs.Sound.play("ThemeSound",createjs.Sound.INTERRUPT_ANY,0,0,-1)),this.layoutRatio()},b.prototype.onBackClick=function(a){this.dispatchEvent(abcya.GameStateEvents.GE_SHOW_MARBLE_DROP)},b.prototype.layoutRatio=function(){game.isWidescreen?(this.lblCorrect.x=500,this.lblCorrect.y=110,this.lblIncorrect.x=500,this.lblIncorrect.y=218,this.lblScore.x=500,this.lblScore.y=390,this.btnBack.x=20,this.btnBack.y=game.screen_height-this.btnBack.getBounds().height-10):(this.lblCorrect.x=520,this.lblCorrect.y=170,this.lblIncorrect.x=520,this.lblIncorrect.y=300,this.lblScore.x=520,this.lblScore.y=500,this.btnBack.x=20,this.btnBack.y=game.screen_height-this.btnBack.getBounds().height-20)},a.abcya.MarbleDropResults=b}(window),function(a){function b(){this.initialize()}a.game=a.game||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.bg=null,b.prototype.penguin=null,b.prototype.penguinShadow=null,b.prototype.resultItems=[],b.prototype.lblRoundNum=null,b.prototype.lblScore=null,b.prototype.btnNext=null,b.prototype.resultsSound=null,b.prototype.score=null,b.prototype.passed=!1,b.prototype.initialize=function(){this.Container_initialize(),this.resultItems=[],game.sceneManager.currentBg="ResultsBackground",game.sceneManager.setBg(),this.penguinShadow=new createjs.Sprite(game.assets.mathsheet,"RoundSelectPenguinShadow"),this.addChild(this.penguinShadow),this.penguin=new createjs.Sprite(game.assets.roundSelectPenguin,"gameIdle"),this.penguin.gotoAndPlay("gameIdle"),this.penguin.x=220,this.penguin.y=200,this.penguin.scaleX=-1,this.penguin.scaleY=1,this.addChild(this.penguin),this.scaleContainer=new createjs.Container,this.resultCircles=new createjs.Sprite(game.assets.mathsheet,"ResultsCircles"),this.scaleContainer.addChild(this.resultCircles),this.scaleContainer.x=game.screen_width-this.scaleContainer.getBounds().width-20,this.lblRoundNum=new createjs.Text(game.gameData.currentRound,"bold 36pt vagrounded_btregular","#FFF"),this.lblRoundNum.textAlign="center",this.lblRoundNum.x=615,this.lblRoundNum.y=45,this.scaleContainer.addChild(this.lblRoundNum);var a=Math.floor(this.makeQuestionDisplays());this.score=a,this.lblScore=new createjs.Text(a+"%","bold 36pt vagrounded_btregular","#2882A5"),this.lblScore.textAlign="center",this.lblScore.x=this.resultCircles.getBounds().width/2-30,this.lblScore.y=480,this.lblScore.alpha=0,this.scaleContainer.addChild(this.lblScore),this.addChild(this.scaleContainer),a>=80?(this.passed=!0,this.makeNextLevelButton(),game.gameData.levelUp()):(this.passed=!1,this.makeTryAgainButton()),this.btnNext.alpha=0,this.layoutRatio(),this.resultsSound=createjs.Sound.play("ResultsSound"),this.penguin.gotoAndPlay("gameTalking"),this.resultsSound.on("complete",this.stopTalking,this),this.resultsSound.on("complete",this.beginShowingMarks,this)},b.prototype.stopTalking=function(){this.penguin.gotoAndPlay("gameIdle")},b.prototype.beginShowingMarks=function(a){for(var b=this.resultItems.length,c=450,d=0;d<b;d++)this.resultItems[d].showMark((d+1)*c);createjs.Tween.get(this.lblScore).wait(c*(this.resultItems.length+1)).call(this.showScore,!1,this)},b.prototype.showScore=function(a){createjs.Sound.play("SlideWhistleSound"),createjs.Tween.get(this.lblScore).to({alpha:1},600).call(this.showNextButton,!1,this)},b.prototype.showNextButton=function(){this.score>=80?createjs.Sound.play("NextLevelSound"):createjs.Sound.play("TryAgainSound"),createjs.Tween.get(this.btnNext).to({alpha:1},400)},b.prototype.makeQuestionDisplays=function(){var a,b,c,d,e,f,g,h,i,j=game.gameData.getCurrentResults(),k=0,l=120,m=35,n=0,o=0;for(b=j.length,a=0;a<b;a++)d=j[a],e=d.num1+d.num2,f=d.num1+" + "+d.num2+" = "+e,g=a<5?140:325,h=a<5?a*m+l:(a-5)*m+l,i=0==d.incorrects,i&&k++,c=new abcya.ResultItem(g,h,f,i),a<5?n=c.getTextWidth()>n?c.getTextWidth():n:o=c.getTextWidth()>o?c.getTextWidth():o,this.resultItems.push(c),this.scaleContainer.addChild(c);var p;for(a=0;a<b;a++)p=a<5?n:o,this.resultItems[a].setMarkX(p);var q=0==k?0:k/b*100;return q},b.prototype.makeTryAgainButton=function(){this.btnNext=new createjs.Sprite(game.assets.mathsheet,"BtnTryAgain"),this.btnNext.x=255,this.btnNext.y=450,this.btnNext.on("mousedown",this.clickNext,this),this.addChild(this.btnNext)},b.prototype.makeNextLevelButton=function(){this.btnNext=new createjs.Sprite(game.assets.mathsheet,"BtnNextLevel"),this.btnNext.on("mousedown",this.clickNext,this),this.btnNext.x=650,this.btnNext.y=450,this.addChild(this.btnNext)},b.prototype.clickNext=function(){this.dispatchEvent(abcya.GameStateEvents.GE_SHOW_ROUND_SELECT)},b.prototype.layoutRatio=function(){var a=game.isWidescreen?.8:1;this.scaleContainer.scaleX=a,this.scaleContainer.scaleY=a,this.penguin.y=game.screen_height-this.penguin.getBounds().height-30,this.penguinShadow.x=this.penguin.x-this.penguin.getBounds().width-75,this.penguinShadow.y=this.penguin.y+this.penguin.getBounds().height-50,this.btnNext.y=game.screen_height-this.btnNext.getBounds().height-30,game.isWidescreen?this.passed?this.btnNext.x=game.screen_width-this.btnNext.getBounds().width-60:this.btnNext.x=225:this.passed?this.btnNext.x=game.screen_width-this.btnNext.getBounds().width-20:this.btnNext.x=255},a.abcya.ResultsScreen=b}(window),function(a){function b(){this.initialize()}a.abcya=a.abcya||{},b.prototype=new createjs.Container,b.prototype.Container_initialize=b.prototype.initialize,b.prototype.penguin=null,b.prototype.penguinShadow=null,b.prototype.buttonsGroup=null,b.prototype.buttonsBackground=null,b.prototype.roundSelectButtons=null,b.prototype.initialize=function(){this.Container_initialize(),game.sceneManager.currentBg="RoundSelectBackground",game.sceneManager.setBg(),this.buttonsGroup=new createjs.Container,this.buttonsBackground=new createjs.Sprite(game.assets.mathsheet,"ButtonBackground"),this.buttonsGroup.addChild(this.buttonsBackground),this.roundSelectButtons=[];for(var a=[{bg:"RoundSelect1",x:-15,y:275},{bg:"RoundSelect2",x:105,y:478},{bg:"RoundSelect3",x:365,y:478},{bg:"RoundSelect4",x:465,y:275},{bg:"RoundSelect5",x:365,y:53},{bg:"RoundSelect6",x:85,y:25}],b=a.length,c=0;c<b;c++){var d=new abcya.RoundSelectButton(a[c].bg,c+1);d.on("click",this.levelSelectClick,this),d.x=a[c].x,d.y=a[c].y,this.roundSelectButtons.push(d),this.buttonsGroup.addChild(d)}this.buttonsGroup.x=0,this.buttonsGroup.y=0,this.addChild(this.buttonsGroup);for(var c=0;c<b;c++)c+1==game.gameData.roundReached&&(this.roundSelectButtons[c].unlock(),game.gameData.lastRoundUnlocked=game.gameData.roundReached);if(this.penguinShadow=new createjs.Sprite(game.assets.mathsheet,"RoundSelectPenguinShadow"),this.addChild(this.penguinShadow),this.penguin=new createjs.Sprite(game.assets.roundSelectPenguin,"gameIdle"),this.penguin.gotoAndPlay("gameIdle"),this.penguin.x=220,this.penguin.scaleX=-1,this.penguin.scaleY=1,this.addChild(this.penguin),!game.gameData.playedRoundInstructions){game.gameData.playedRoundInstructions=!0;var e=createjs.Sound.play("RoundSelectSound");e.on("complete",this.stopTalking,this),this.penguin.gotoAndPlay("gameTalking")}this.layoutRatio(),game.bgMusic||(game.bgMusic=createjs.Sound.play("ThemeSound",createjs.Sound.INTERRUPT_ANY,0,0,-1))},b.prototype.levelSelectClick=function(a){a.currentTarget.isLocked||(game.gameData.currentRound=a.currentTarget.roundNum,a.currentTarget.roundNum<=5?this.dispatchEvent(abcya.GameStateEvents.GE_ROUND_SELECT):this.dispatchEvent(abcya.GameStateEvents.GE_SHOW_MARBLE_DROP))},b.prototype.stopTalking=function(){this.penguin.gotoAndPlay("gameIdle")},b.prototype.layoutRatio=function(){var a=game.isWidescreen?.8:1,b=game.isWidescreen?60:130;this.buttonsGroup.scaleX=a,this.buttonsGroup.scaleY=a,this.buttonsGroup.x=game.screen_width-this.buttonsGroup.getBounds().width*a-25*a,this.buttonsGroup.y=game.screen_height/2-this.buttonsGroup.getBounds().height*a/2,this.penguin.y=game.screen_height-this.penguin.getBounds().height-b,this.penguinShadow.x=this.penguin.x-this.penguin.getBounds().width-85,this.penguinShadow.y=this.penguin.y+this.penguin.getBounds().height-46},b.prototype.tick=function(a){},a.abcya.RoundSelectScreen=b}(window);